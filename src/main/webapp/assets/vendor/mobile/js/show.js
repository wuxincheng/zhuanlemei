/*
 *	jQuery dotdotdot 1.6.16
 *
 *	Copyright (c) Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Dual licensed under the MIT and GPL licenses.
 *	http://en.wikipedia.org/wiki/MIT_License
 *	http://en.wikipedia.org/wiki/GNU_General_Public_License
 */
!function(t,e){function i(t,e,i){var n=t.children(),a=!1;t.empty();for(var r=0,s=n.length;s>r;r++){var l=n.eq(r);if(t.append(l),i&&t.append(i),o(t,e)){l.remove(),a=!0;break}i&&i.detach()}return a}function n(e,i,r,s,l){var c=!1,u="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",d="script, .dotdotdot-keep";return e.contents().detach().each(function(){var h=this,p=t(h);if("undefined"==typeof h||3==h.nodeType&&0==t.trim(h.data).length)return!0;if(p.is(d))e.append(p);else{if(c)return!0;e.append(p),l&&e[e.is(u)?"after":"append"](l),o(r,s)&&(c=3==h.nodeType?a(p,i,r,s,l):n(p,i,r,s,l),c||(p.detach(),c=!0)),c||l&&l.detach()}}),c}function a(e,i,n,a,s){var u=e[0];if(!u)return!1;var h=c(u),p=-1!==h.indexOf(" ")?" ":"\u3000",f="letter"==a.wrap?"":p,m=h.split(f),g=-1,v=-1,y=0,w=m.length-1;for(a.fallbackToLetter&&0==y&&0==w&&(f="",m=h.split(f),w=m.length-1);w>=y&&(0!=y||0!=w);){var b=Math.floor((y+w)/2);if(b==v)break;v=b,l(u,m.slice(0,v+1).join(f)+a.ellipsis),o(n,a)?(w=v,a.fallbackToLetter&&0==y&&0==w&&(f="",m=m[0].split(f),g=-1,v=-1,y=0,w=m.length-1)):(g=v,y=v)}if(-1==g||1==m.length&&0==m[0].length){var x=e.parent();e.detach();var C=s&&s.closest(x).length?s.length:0;x.contents().length>C?u=d(x.contents().eq(-1-C),i):(u=d(x,i,!0),C||x.detach()),u&&(h=r(c(u),a),l(u,h),C&&s&&t(u).parent().append(s))}else h=r(m.slice(0,g+1).join(f),a),l(u,h);return!0}function o(t,e){return t.innerHeight()>e.maxHeight}function r(e,i){for(;t.inArray(e.slice(-1),i.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),i.lastCharacter.noEllipsis)<0&&(e+=i.ellipsis),e}function s(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function c(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function u(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function d(e,i,n){var a,o=e&&e[0];if(o){if(!n){if(3===o.nodeType)return o;if(t.trim(e.text()))return d(e.contents().last(),i)}for(a=u(o);!a;){if(e=e.parent(),e.is(i)||!e.length)return!1;a=u(e[0])}if(a)return d(t(a),i)}return!1}function h(e,i){return e?"string"==typeof e?(e=t(e,i),e.length?e:!1):e.jquery?e:!1:!1}function p(t){for(var e=t.innerHeight(),i=["paddingTop","paddingBottom"],n=0,a=i.length;a>n;n++){var o=parseInt(t.css(i[n]),10);isNaN(o)&&(o=0),e-=o}return e}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return t.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var a=this;a.data("dotdotdot")&&a.trigger("destroy:dot"),a.data("dotdotdot-style",a.attr("style")||""),a.css("word-wrap","break-word"),"nowrap"===a.css("white-space")&&a.css("white-space","normal"),a.bind_events=function(){return a.bind("update:dot",function(e,s){e.preventDefault(),e.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:p(a),l.maxHeight+=l.tolerance,"undefined"!=typeof s&&(("string"==typeof s||s instanceof HTMLElement)&&(s=t("<div />").append(s).contents()),s instanceof t&&(r=s)),m=a.wrapInner('<div class="dotdotdot" />').children(),m.contents().detach().end().append(r.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var u=!1,d=!1;return c.afterElement&&(u=c.afterElement.clone(!0),u.show(),c.afterElement.detach()),o(m,l)&&(d="children"==l.wrap?i(m,l,u):n(m,a,m,l,u)),m.replaceWith(m.contents()),m=null,t.isFunction(l.callback)&&l.callback.call(a[0],d,r),c.isTruncated=d,d}).bind("isTruncated:dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(a[0],c.isTruncated),c.isTruncated}).bind("originalContent:dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(a[0],r),r}).bind("destroy:dot",function(t){t.preventDefault(),t.stopPropagation(),a.unwatch().unbind_events().contents().detach().end().append(r).attr("style",a.data("dotdotdot-style")||"").data("dotdotdot",!1)}),a},a.unbind_events=function(){return a.unbind(".dot"),a},a.watch=function(){if(a.unwatch(),"window"==l.watch){var e=t(window),i=e.width(),n=e.height();e.bind("resize.dot"+c.dotId,function(){i==e.width()&&n==e.height()&&l.windowResizeFix||(i=e.width(),n=e.height(),d&&clearInterval(d),d=setTimeout(function(){a.trigger("update:dot")},100))})}else u=s(a),d=setInterval(function(){if(a.is(":visible")){var t=s(a);(u.width!=t.width||u.height!=t.height)&&(a.trigger("update:dot"),u=t)}},500);return a},a.unwatch=function(){return t(window).unbind("resize.dot"+c.dotId),d&&clearInterval(d),a};var r=a.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),c={},u={},d=null,m=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),c.afterElement=h(l.after,a),c.isTruncated=!1,c.dotId=f++,a.data("dotdotdot",!0).bind_events().trigger("update:dot"),l.watch&&a.watch(),a},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","\u3000",",",";",".","!","?"],noEllipsis:[]}},t.fn.dotdotdot.debug=function(){};var f=1,m=t.fn.html;t.fn.html=function(i){return i!=e&&!t.isFunction(i)&&this.data("dotdotdot")?this.trigger("update",[i]):m.apply(this,arguments)};var g=t.fn.text;t.fn.text=function(i){return i!=e&&!t.isFunction(i)&&this.data("dotdotdot")?(i=t("<div />").text(i).html(),this.trigger("update",[i])):g.apply(this,arguments)}}}(window.jQuery||window.Zepto),function(t,e){e.highConcurrencyConfig={sampleRate:{rate:parseFloat(t("body").attr("data-sampleRate")||1)}},t.fn.utils={smartDate:function(e){"string"==typeof e&&(e=t(e)),e.each(function(){var e,i,n=t(this),a=!1,o=!1,r=!1,s=new Date;n.attr("data-originDate")&&(e=new Date(n.attr("data-originDate").replace(/-/g,"/")),i=Math.round((s.getTime()-e.getTime())/6e4),i<=60*s.getHours()&&(a=!0),s.getDate()-e.getDate()==1&&(o=!0),s.getFullYear()-e.getFullYear()>=1&&(r=!0),n.text(30>i&&a?"\u521a\u521a":60>i&&a?i+" \u5206\u949f\u524d":1440>i&&a?Math.floor(i/60)+" \u5c0f\u65f6\u524d":2880>i&&o?"\u6628\u5929":r?e.getFullYear()+" \u5e74 "+(e.getMonth()+1)+" \u6708 "+e.getDate()+" \u65e5":e.getMonth()+1+" \u6708 "+e.getDate()+" \u65e5"))})},smartDotdotdot:function(e){"string"==typeof e&&(e=t(e)),e.each(function(){t(this);e.dotdotdot({wrap:"letter"})})},isLogined:function(){return"true"==t(".com-header").attr("data-isLogined")?!0:!1},getComponentInstance:function(e){var i;return"undefined"==typeof e?null:("string"==typeof e&&(e=t(e)),e=e.eq(0),i=e.attr("data-guid"),COMS[i])},isMakeSample:function(){var t,i=!1;return e.highConcurrencyConfig&&(t=e.highConcurrencyConfig.sampleRate),Math.random()<t.rate&&(i=!0),i},transitionEnd:function(t,e){function i(o){if(o.target===this)for(e.call(this,o),n=0;n<a.length;n++)t.off(a[n],i)}var n,a=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"];if(e)for(n=0;n<a.length;n++)t.on(a[n],i)},throttle:function(t,e,i){var n=!1;return i||(i={}),function(){var a=this,o=arguments;n||(i.leading!==!1&&t.apply(a,o),n=!0,setTimeout(function(){i.trailing!==!1&&t.apply(a,o),n=!1},e))}},debounce:function(t,e,i){var n;i||(i={});var a=!1;return function(){var o=this,r=arguments;a||i.leading===!1||t.apply(o,r),a=!0,n&&clearTimeout(n),n=setTimeout(function(){i.trailing!==!1&&t.apply(o,r),a=!1},e)}},showNotification:function(i){var n='<div class="com-notification">                                        <div class="notification-bd">                                            <p class="msg"></p>                                        </div>                                    </div>';0==t(".com-notification").length&&t("body").append(n),t(".com-notification").find(".msg").text(i||"\u51fa\u9519\u5566~"),t(".com-notification").css({left:(t(e).outerWidth()-t(".com-notification").outerWidth())/2,top:(t(e).outerHeight()-t(".com-notification").outerHeight())/2-40}),t(".com-notification").fadeIn(),setTimeout(function(){t.fn.utils.hideNotification()},2e3)},hideNotification:function(){t(".com-notification").length&&t(".com-notification").fadeOut(function(){t(".com-notification").remove()})},isLogin:function(){var e=t(".com-header .signin");return e.hasClass("hidden")?!1:!0},template:function(e,i,n){var a,o=/\\|'|\r|\n|\t|\u2028|\u2029/g;n=t.extend({},n,{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g});var r=new RegExp([(n.escape||noMatch).source,(n.interpolate||noMatch).source,(n.evaluate||noMatch).source].join("|")+"|$","g"),s=0,l="__p+='";e.replace(r,function(t,i,n,a,r){return l+=e.slice(s,r).replace(o,function(t){return"\\"+escapes[t]}),i&&(l+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(l+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(l+="';\n"+a+"\n__p+='"),s=r+t.length,t}),l+="';\n",n.variable||(l="with(obj||{}){\n"+l+"}\n"),l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{a=new Function(n.variable||"obj","_",l)}catch(c){throw c.source=l,c}if(i)return a(i);var u=function(t){return a.call(this,t)};return u.source="function("+(n.variable||"obj")+"){\n"+l+"}",u}}}(window.jQuery||window.Zepto,window,document),function(t){function e(){var e=t("body"),i=t.fn.utils.getComponentInstance(".com-header");i&&(i.updateLoginInfo(),e.find(".com-login-popup").on("LoginPopup::loginsuccess",function(){t.fn.utils.getComponentInstance(".com-header").updateLoginInfo()}),e.find(".com-login-popup").on("LoginPopup::registersuccess",function(){t.fn.utils.getComponentInstance(".com-header").updateLoginInfo()}))}t.fn.initLoginStatus=e}(window.jQuery||window.Zepto,window,document),function(t,e){function i(i){function n(){c=!0,t.ajax({url:a,type:"GET",dataType:"json",data:t.extend(i.param,{page:s}),success:function(e){if(e&&e.status){var n=e.data,a=t(n.html);elHTMLContainer.append(a),i.callback&&(a=i.callback(a)),n.page?(c=!1,s=n.page):(l=t.fn.utils.getComponentInstance(r),l.setStatus("stop"))}},error:function(){}})}var a,o,r,s,l,c=(t("body"),!1);i=t.extend({prefetch:!1,page:1,baseUrl:null,elContainer:null,elLoader:null,param:{}},i),s=i.page,a=i.baseUrl,o=i.elContainer,elHTMLContainer=i.elHTMLContainer||o,r=i.elLoader,"/"!=a[a.length-1]&&(a+="/"),i.prefetch&&n(),t(e).on("scroll",function(){if(!c){var i=t(e).scrollTop(),a=t(e).height(),r=o.height(),s=o.offset().top,l=120;i+a+l>=s+r&&n()}})}function n(i){function n(){l=!0,t.ajax({url:a+s+".json",type:"GET",dataType:"json",data:{},success:function(e){if(e&&e.status){var n=e.data,a=t(n.html);elHTMLContainer.append(a),i.callback&&i.callback(a),n.last_key?(l=!1,s=n.last_key):(comLoader=t.fn.utils.getComponentInstance(r),comLoader.setStatus("stop"))}else t.fn.utils.showNotification(e.message)},error:function(){t.fn.utils.showNotification(),comLoader=t.fn.utils.getComponentInstance(r),comLoader.setStatus("vhidden")}})}var a,o,r,s,l=(t("body"),!1);return i=t.extend({lastKey:0,baseUrl:null,elContainer:null,elHTMLContainer:null,elLoader:null},i),s=i.lastKey,a=i.baseUrl,o=i.elContainer,elHTMLContainer=i.elHTMLContainer||o,r=i.elLoader,s&&"0"!=s?("/"!=a[a.length-1]&&(a+="/"),i.prefetch&&n(),void t(e).on("scroll",function(){if(!l){var i=t(e).scrollTop(),a=t(e).height(),r=o.height(),s=o.offset().top,c=120;i+a+c>=s+r&&n()}})):(comLoader=t.fn.utils.getComponentInstance(r),void comLoader.setStatus("stop"))}function a(t){switch(t=t||{},t.type){case"page":i(t);break;case"lastKey":n(t);break;default:n(t)}}t.fn.initLoadMore=a}(window.jQuery||window.Zepto,window,document),function(t,e){function i(i){var n=i.elContainer,a=i.elOriginContainer,o=t('<div class="packery-item combo">'),r=t('<div class="packery-item single">');a.find(".com-grid-article, .com-grid-key-article, .com-grid-paper, .com-grid-makemoney").each(function(){var e=t(this),i=n.find(".packery-item:last"),a=i.children().length;return i.hasClass("combo")?void(e.hasClass("com-grid-article")||e.hasClass("com-grid-makemoney")?i.append(e):(n.append(r.clone().append(e)),a%2==1&&(n.append(o.clone().append(i.children().last())),!i.children().length&&i.remove()))):!i.length||i.hasClass("single")?void n.append(e.hasClass("com-grid-article")||e.hasClass("com-grid-makemoney")?o.clone().append(e):r.clone().append(e)):void 0}),"Android"==t.ua.os.name&&"QQBrowser"==t.ua.browser.name&&n.find(".combo .com-grid-article").css("width",(t(e).width()-2)/2)}t.fn.initLayout=i}(window.jQuery||window.Zepto,window,document),function(t){function e(){var e=t("body");e.on("click","a",function(e){var i=t(e.currentTarget);return"_blank"!=i.attr("target")&&i.attr("target","_self"),!0})}t.fn.initLink=e}(window.jQuery||window.Zepto,window,document),function(t,e,i){var n=0,a=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};a.prototype={init:function(){var t=this,i=t.el;return t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){var e=this,i=e.el;i.on("click","form.login .btn.submit",function(n){n.preventDefault();var a=t(n.currentTarget),o=a.parents("form");t.ajax({url:"/users/sign_in",type:"POST",dataType:"json",data:{"user[remember_me]":!0,"user[email]":o.find('[name="user[email]"]').val(),"user[password]":o.find('[name="user[password]"]').val(),authenticity_token:t('[name="csrf-token"]').attr("content")},success:function(n){n&&n.status?(i.trigger("LoginPopup::loginsuccess"),e.closePopup()):t.fn.utils.showNotification(n.message)},error:function(e){var i=e.responseJSON;t.fn.utils.showNotification(i.error)}})}),i.on("click","form.register .btn.submit",function(e){e.preventDefault();var n=t(e.currentTarget),a=n.parents("form");t.ajax({url:"/mobile/users/verify",type:"POST",dataType:"json",data:{"user[email]":a.find('[name="user[email]"]').val(),"user[password]":a.find('[name="user[password]"]').val(),"user[password_confirmation]":a.find('[name="user[password_confirmation]"]').val(),authenticity_token:t('[name="csrf-token"]').attr("content")},success:function(e){if(e&&e.status){var a=n.parents("form"),o=i.find("form.info");a.hide().removeClass("active"),o.fadeIn(400,function(){o.addClass("active")})}else t.fn.utils.showNotification(e.message)},error:function(e){var i=e.responseJSON;t.fn.utils.showNotification(i.error)}})}),i.on("click","form.info .btn.submit",function(n){if(n.preventDefault(),e.validateInfoForm()){var a=t(n.currentTarget),o=a.parents("form"),r=i.find("form.register");t.ajax({url:"/users",type:"POST",dataType:"json",data:{"user[email]":r.find('[name="user[email]"]').val(),"user[password]":r.find('[name="user[password]"]').val(),"user[password_confirmation]":r.find('[name="user[password_confirmation]"]').val(),"user[username]":o.find('[name="user[username]"]').val(),"user[description]":o.find('[name="user[description]"]').val(),authenticity_token:t('[name="csrf-token"]').attr("content")},success:function(t){t&&t.status&&(i.trigger("LoginPopup::registersuccess"),e.closePopup())},error:function(e){var i=e.responseJSON;t.fn.utils.showNotification(i.error)}})}}),i.on("click","form.findpassword .btn.submit",function(i){i.preventDefault();var n=t(i.currentTarget),a=n.parents("form");t.ajax({url:"/users/password",type:"POST",dataType:"json",data:{"user[email]":a.find('[name="user[email]"]').val(),authenticity_token:t('[name="csrf-token"]').attr("content")},success:function(i){i&&i.status?(t.fn.utils.showNotification(i.message),e.closePopup()):t.fn.utils.showNotification(i.message)},error:function(e){var i=e.responseJSON;t.fn.utils.showNotification(i.error)}})}),i.on("click",".form-links a",function(e){e.preventDefault();var n=t(e.currentTarget),a=n.parents("form"),o=i.find(n.attr("data-toForm"));a.hide().removeClass("active"),o.fadeIn(400,function(){o.addClass("active")})}),i.on("click",".close-popup",function(t){t.preventDefault(),e.closePopup()}),i.on("transitionend webkitTransitionEnd oTransitionEnd",function(){i.hasClass("modal-in")?(n=t("body").scrollTop(),t("body").scrollTop(0),t("html").addClass("fixed"),i.addClass("absolute")):i.removeClass("modal-out").hide()})},updateLoginInfo:function(){var n,a,o=this,r=o.el,s=r.find(".section-right .user");e.innerWidth?n=e.innerWidth:i.body&&i.body.clientWidth&&(n=e.body.clientWidth),e.innerHeight?a=e.innerHeight:i.body&&i.body.clientHeight&&(a=e.body.clientHeight),t.ajax({url:"/get_user_and_radar.json",type:"GET",dataType:"json",data:{winWidth:n,winHeight:a},success:function(e){var i=t.fn.utils.getComponentInstance(".com-grid-login"),n=t.fn.utils.getComponentInstance(".com-page-footer"),a=t.fn.utils.getComponentInstance(".com-recommend-articles");if(e&&e.status){var o=e.data;s.attr("data-isLogined",!0),s.find(".avatar img").attr("src",o.face),s.find(".avatar").attr("href","/display/users/"+o.id),s.find(".text").attr("href","/display/users/"+o.id).text(o.name),s.find(".logout").removeClass("hidden"),i&&(i.updateLoginInfo(o),i.renderRadar(o.radar)),n&&n.updateLoginInfo(o),a&&a.setCuriositiesData(o.radar)}else i&&i.renderRadar(),a&&a.setCuriositiesData(!0)},error:function(){}})},validateInfoForm:function(){var e=this,i=e.el,n=i.find("form.info"),a=n.find('[name="user[username]"]').val();return a?!0:(t.fn.utils.showNotification("\u8bf7\u586b\u5165\u6635\u79f0"),!1)},openPopup:function(){var e=this,i=e.el;return i.show(),0==t(".popup-overlay").length&&t("body").append('<div class="popup-overlay">'),t(".popup-overlay").addClass("modal-overlay-visible"),setTimeout(function(){i.removeClass("modal-out").addClass("modal-in")},50),!0},closePopup:function(){var e=this,i=e.el,a=t(".popup-overlay");return i.removeClass("absolute"),t("html").removeClass("fixed"),setTimeout(function(){t("body").scrollTop(n),i.length===t(".popup.modal-in").length&&a.removeClass("modal-overlay-visible"),i.removeClass("modal-in").addClass("modal-out")},50),!0}},t.fn.LoginPopup=function(e){var i;return this.each(function(){var n=t(this);"true"!=n.attr("data-initialized")&&(i=new a(n,e),i.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e,i){var n=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};n.prototype={init:function(){var i=this,n=i.el;return t(".com-login-popup").LoginPopup(),i.bindEvents(),e.COMS=e.COMS||[],n.attr("data-guid",e.COMS.length),n.attr("data-initialized","true"),e.COMS.push(i),i},bindEvents:function(){var e=this,n=e.el;n.on("click",".open-popup",function(e){e.preventDefault();t(e.currentTarget);t.fn.utils.getComponentInstance(".com-login-popup").openPopup()}),n.on("click",".user.signin .account-logout a",function(e){e.preventDefault();var i=t(e.currentTarget),n=i.parents("form");n.find('[name="authenticity_token"]').val(t('[name="csrf-token"]').attr("content")),n.submit()}),n.on("click",".user.signin .user-hd",function(e){e.preventDefault();var i=t(e.currentTarget),n=i.siblings(".user-bd");n.toggleClass("hidden"),t("body").toggleClass("menu-overlay-show")}),t(i).on("click",".menu-overlay",function(e){e.preventDefault();var i=n.find(".signin .user-bd");i.toggleClass("hidden"),t("body").toggleClass("menu-overlay-show")})},updateLoginInfo:function(){var n,a,o=this,r=o.el,s=r.find(".user.signin"),l=r.find(".user.unsign");e.innerWidth?n=e.innerWidth:i.body&&i.body.clientWidth&&(n=e.body.clientWidth),e.innerHeight?a=e.innerHeight:i.body&&i.body.clientHeight&&(a=e.body.clientHeight),t.ajax({url:"/mobile/get_user_and_radar.json",type:"GET",dataType:"json",data:{winWidth:n,winHeight:a},success:function(e){var i=t.fn.utils.getComponentInstance(".com-sidebar-panel");if(e&&e.status){var n=e.data;r.attr("data-isLogined","true"),s.removeClass("hidden"),l.addClass("hidden"),s.find(".name").text(n.name),s.find(".items .item:eq(0)").find("a").attr("href","/webapp/users/"+n.id),i&&(i.updateLoginInfo(n),i.renderRadar(n.radar))}else i&&i.renderRadar()},error:function(){}})}},t.fn.Header=function(e){var i;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(i=new n(a,e),i.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i={},n=0,a=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};a.prototype={init:function(){var t=this,i=t.el;return t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){var e=this,a=e.el;a.on("click",".close-popup",function(t){t.preventDefault(),e.closePopup()}),a.on("click",".comment-popup-hd .submit",function(n){n.preventDefault();var o=(t(n.currentTarget),a.find(".comment-popup-bd form")),r=!1;1==!!o.find('[name="comment[parent_id]"]').val()&&(r=!0),t.ajax({url:"/mobile/comments/create_comment",type:"POST",dataType:"json",data:t.extend({comment_type:"article",parent_id:0,content:a.find('[name="content"]').val()},i),success:function(i){if(i&&i.status){var n=i.data;a.trigger("CommentPopup::addComment",{data:n,isReplyComment:r}),o.find('[name="content"]').val(""),e.closePopup()}else t.fn.utils.showNotification(i.message)},error:function(e){var i=e.responseJSON||{};t.fn.utils.showNotification(i.error)}})}),a.on("transitionend webkitTransitionEnd oTransitionEnd",function(){a.hasClass("modal-in")?(n=t("body").scrollTop(),t("body").scrollTop(0),t("html").addClass("fixed"),a.addClass("absolute")):(t(".com-toolbar").show(),a.removeClass("modal-out").hide())})},openPopup:function(e){var n,a=this,o=a.el;return t.fn.utils.isLogined()?(o.find('[name="content"]').attr("placeholder",e.placeholder||"\u6211\u6709\u610f\u89c1"),e.placeholder=null,o.show(),0==t(".popup-overlay").length&&t("body").append('<div class="popup-overlay">'),t(".popup-overlay").addClass("modal-overlay-visible"),setTimeout(function(){t(".com-toolbar").hide(),o.removeClass("modal-out").addClass("modal-in")},50),i=e||{},!0):(n=t.fn.utils.getComponentInstance(".com-login-popup"),void(n&&n.openPopup()))},closePopup:function(){var e=this,i=e.el,a=t(".popup-overlay");return i.removeClass("absolute"),t("html").removeClass("fixed"),setTimeout(function(){t("body").scrollTop(n),i.length===t(".popup.modal-in").length&&a.removeClass("modal-overlay-visible"),i.removeClass("modal-in").addClass("modal-out")},50),!0}},t.fn.CommentPopup=function(e){var i;return this.each(function(){var n=t(this);"true"!=n.attr("data-initialized")&&(i=new a(n,e),i.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return setTimeout(function(){i.addClass("animated fadeInUp").removeClass("hidden")},1e3),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){var e=this,i=e.el;i.on("animationend webkitanimationend mozanimationend msanimationend oanimationend",function(e){e.preventDefault();var i=t(e.currentTarget);i.removeClass("animated fadeInUp")}),i.on("click",".close",function(t){t.preventDefault(),i.remove()})}},t.fn.DownloadBanner=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var i=this,n=i.el;return t(".com-comment-popup").CommentPopup(),t(".com-download-banner").DownloadBanner(),i.bindEvents(),e.COMS=e.COMS||[],n.attr("data-initialized","true"),n.attr("data-guid",e.COMS.length),e.COMS.push(i),i},bindEvents:function(){var e=this,i=e.el;i.on("click",".open-popup",function(e){e.preventDefault();var n=t(e.currentTarget),a=t(n.attr("data-popup"));t.fn.utils.getComponentInstance(a).openPopup({id:i.attr("data-id"),comment_type:i.attr("data-type")})});var n=i.attr("data-id"),a="Qdaily.article_"+n+".isMarked";localStorage.getItem(a)&&i.find(".toolbar-left .icon-heart").addClass("marked"),i.on("click",".toolbar-left .icon-heart",function(e){e.preventDefault();var i=t(e.currentTarget),o=i.hasClass("marked")?!0:!1,r=parseInt(i.text())||0;r=o?r-1:r+1,i.toggleClass("marked"),i.text(r>0?r:""),t.ajax({url:"/mobile/praises/create_praise",type:"POST",dataType:"json",data:{id:n,praise_type:"article",genre:o?2:1},success:function(t){if(t&&t.status){{t.data}localStorage.getItem(a)?localStorage.removeItem(a):localStorage.setItem(a,"true")}}})})}},t.fn.Toolbar=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document);/*!
 *  Copyright 2011 Twitter, Inc.
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
var Hogan={};!function(t){function e(t,e,i){var n;return e&&"object"==typeof e&&(null!=e[t]?n=e[t]:i&&e.get&&"function"==typeof e.get&&(n=e.get(t))),n}function i(t,e,i,n,a,o){function r(){}function s(){}r.prototype=t,s.prototype=t.subs;var l,c=new r;c.subs=new s,c.subsText={},c.buf="",n=n||{},c.stackSubs=n,c.subsText=o;for(l in e)n[l]||(n[l]=e[l]);for(l in n)c.subs[l]=n[l];a=a||{},c.stackPartials=a;for(l in i)a[l]||(a[l]=i[l]);for(l in a)c.partials[l]=a[l];return c}function n(t){return String(null===t||void 0===t?"":t)}function a(t){return t=n(t),u.test(t)?t.replace(o,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(l,"&#39;").replace(c,"&quot;"):t}t.Template=function(t,e,i,n){t=t||{},this.r=t.code||this.r,this.c=i,this.options=n||{},this.text=e||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(){return""},v:a,t:n,render:function(t,e,i){return this.ri([t],e||{},i)},ri:function(t,e,i){return this.r(t,e,i)},ep:function(t,e){var n=this.partials[t],a=e[n.name];if(n.instance&&n.base==a)return n.instance;if("string"==typeof a){if(!this.c)throw new Error("No compiler available.");a=this.c.compile(a,this.options)}if(!a)return null;if(this.partials[t].base=a,n.subs){e.stackText||(e.stackText={});for(key in n.subs)e.stackText[key]||(e.stackText[key]=void 0!==this.activeSub&&e.stackText[this.activeSub]?e.stackText[this.activeSub]:this.text);a=i(a,n.subs,n.partials,this.stackSubs,this.stackPartials,e.stackText)}return this.partials[t].instance=a,a},rp:function(t,e,i,n){var a=this.ep(t,i);return a?a.ri(e,i,n):""},rs:function(t,e,i){var n=t[t.length-1];if(!d(n))return void i(t,e,this);for(var a=0;a<n.length;a++)t.push(n[a]),i(t,e,this),t.pop()},s:function(t,e,i,n,a,o,r){var s;return d(t)&&0===t.length?!1:("function"==typeof t&&(t=this.ms(t,e,i,n,a,o,r)),s=!!t,!n&&s&&e&&e.push("object"==typeof t?t:e[e.length-1]),s)},d:function(t,i,n,a){var o,r=t.split("."),s=this.f(r[0],i,n,a),l=this.options.modelGet,c=null;if("."===t&&d(i[i.length-2]))s=i[i.length-1];else for(var u=1;u<r.length;u++)o=e(r[u],s,l),null!=o?(c=s,s=o):s="";return a&&!s?!1:(a||"function"!=typeof s||(i.push(c),s=this.mv(s,i,n),i.pop()),s)},f:function(t,i,n,a){for(var o=!1,r=null,s=!1,l=this.options.modelGet,c=i.length-1;c>=0;c--)if(r=i[c],o=e(t,r,l),null!=o){s=!0;break}return s?(a||"function"!=typeof o||(o=this.mv(o,i,n)),o):a?!1:""},ls:function(t,e,i,a,o){var r=this.options.delimiters;return this.options.delimiters=o,this.b(this.ct(n(t.call(e,a)),e,i)),this.options.delimiters=r,!1},ct:function(t,e,i){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(t,this.options).render(e,i)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,e,i,n,a,o,r){var s,l=e[e.length-1],c=t.call(l);return"function"==typeof c?n?!0:(s=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,l,i,s.substring(a,o),r)):c},mv:function(t,e,i){var a=e[e.length-1],o=t.call(a);return"function"==typeof o?this.ct(n(o.call(a)),a,i):o},sub:function(t,e,i,n){var a=this.subs[t];a&&(this.activeSub=t,a(e,i,this,n),this.activeSub=!1)}};var o=/&/g,r=/</g,s=/>/g,l=/\'/g,c=/\"/g,u=/[&<>\"\']/,d=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}("undefined"!=typeof exports?exports:Hogan),function(t){function e(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function i(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function n(t,e,i){if(e.charAt(i)!=t.charAt(0))return!1;for(var n=1,a=t.length;a>n;n++)if(e.charAt(i+n)!=t.charAt(n))return!1;return!0}function a(e,i,n,s){var l=[],c=null,u=null,d=null;for(u=n[n.length-1];e.length>0;){if(d=e.shift(),u&&"<"==u.tag&&!(d.tag in w))throw new Error("Illegal content in < super tag.");if(t.tags[d.tag]<=t.tags.$||o(d,s))n.push(d),d.nodes=a(e,d.tag,n,s);else{if("/"==d.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+d.n);if(c=n.pop(),d.n!=c.n&&!r(d.n,c.n,s))throw new Error("Nesting error: "+c.n+" vs. "+d.n);return c.end=d.i,l}"\n"==d.tag&&(d.last=0==e.length||"\n"==e[0].tag)}l.push(d)}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return l}function o(t,e){for(var i=0,n=e.length;n>i;i++)if(e[i].o==t.n)return t.tag="#",!0}function r(t,e,i){for(var n=0,a=i.length;a>n;n++)if(i[n].c==t&&i[n].o==e)return!0}function s(t){var e=[];for(var i in t)e.push('"'+c(i)+'": function(c,p,t,i) {'+t[i]+"}");return"{ "+e.join(",")+" }"}function l(t){var e=[];for(var i in t.partials)e.push('"'+c(i)+'":{name:"'+c(t.partials[i].name)+'", '+l(t.partials[i])+"}");return"partials: {"+e.join(",")+"}, subs: "+s(t.subs)}function c(t){return t.replace(y,"\\\\").replace(m,'\\"').replace(g,"\\n").replace(v,"\\r")}function u(t){return~t.indexOf(".")?"d":"f"}function d(t,e){var i="<"+(e.prefix||""),n=i+t.n+b++;return e.partials[n]={name:t.n,partials:{}},e.code+='t.b(t.rp("'+c(n)+'",c,p,"'+(t.indent||"")+'"));',n}function h(t,e){e.code+="t.b(t.t(t."+u(t.n)+'("'+c(t.n)+'",c,p,0)));'}function p(t){return"t.b("+t+");"}var f=/\S/,m=/\"/g,g=/\n/g,v=/\r/g,y=/\\/g;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(a,o){function r(){y.length>0&&(w.push({tag:"_t",text:new String(y)}),y="")}function s(){for(var e=!0,i=C;i<w.length;i++)if(e=t.tags[w[i].tag]<t.tags._v||"_t"==w[i].tag&&null===w[i].text.match(f),!e)return!1;return e}function l(t,e){if(r(),t&&s())for(var i,n=C;n<w.length;n++)w[n].text&&((i=w[n+1])&&">"==i.tag&&(i.indent=w[n].text.toString()),w.splice(n,1));else e||w.push({tag:"\n"});b=!1,C=w.length}function c(t,e){var n="="+k,a=t.indexOf(n,e),o=i(t.substring(t.indexOf("=",e)+1,a)).split(" ");return S=o[0],k=o[o.length-1],a+n.length-1}var u=a.length,d=0,h=1,p=2,m=d,g=null,v=null,y="",w=[],b=!1,x=0,C=0,S="{{",k="}}";for(o&&(o=o.split(" "),S=o[0],k=o[1]),x=0;u>x;x++)m==d?n(S,a,x)?(--x,r(),m=h):"\n"==a.charAt(x)?l(b):y+=a.charAt(x):m==h?(x+=S.length-1,v=t.tags[a.charAt(x+1)],g=v?a.charAt(x+1):"_v","="==g?(x=c(a,x),m=d):(v&&x++,m=p),b=x):n(k,a,x)?(w.push({tag:g,n:i(y),otag:S,ctag:k,i:"/"==g?b-S.length:x+k.length}),y="",x+=k.length-1,m=d,"{"==g&&("}}"==k?x++:e(w[w.length-1]))):y+=a.charAt(x);return l(b,!0),w};var w={_t:!0,"\n":!0,$:!0,"/":!0};t.stringify=function(e){return"{code: function (c,p,i) { "+t.wrapMain(e.code)+" },"+l(e)+"}"};var b=0;t.generate=function(e,i,n){b=0;var a={code:"",subs:{},partials:{}};return t.walk(e,a),n.asString?this.stringify(a,i,n):this.makeTemplate(a,i,n)},t.wrapMain=function(t){return'var t=this;t.b(i=i||"");'+t+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(t,e,i){var n=this.makePartials(t);return n.code=new Function("c","p","i",this.wrapMain(t.code)),new this.template(n,e,this,i)},t.makePartials=function(t){var e,i={subs:{},partials:t.partials,name:t.name};for(e in i.partials)i.partials[e]=this.makePartials(i.partials[e]);for(e in t.subs)i.subs[e]=new Function("c","p","t","i",t.subs[e]);return i},t.codegen={"#":function(e,i){i.code+="if(t.s(t."+u(e.n)+'("'+c(e.n)+'",c,p,1),c,p,0,'+e.i+","+e.end+',"'+e.otag+" "+e.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(e.nodes,i),i.code+="});c.pop();}"},"^":function(e,i){i.code+="if(!t.s(t."+u(e.n)+'("'+c(e.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(e.nodes,i),i.code+="};"},">":d,"<":function(e,i){var n={partials:{},code:"",subs:{},inPartial:!0};t.walk(e.nodes,n);var a=i.partials[d(e,i)];a.subs=n.subs,a.partials=n.partials},$:function(e,i){var n={subs:{},code:"",partials:i.partials,prefix:e.n};t.walk(e.nodes,n),i.subs[e.n]=n.code,i.inPartial||(i.code+='t.sub("'+c(e.n)+'",c,p,i);')},"\n":function(t,e){e.code+=p('"\\n"'+(t.last?"":" + i"))},_v:function(t,e){e.code+="t.b(t.v(t."+u(t.n)+'("'+c(t.n)+'",c,p,0)));'},_t:function(t,e){e.code+=p('"'+c(t.text)+'"')},"{":h,"&":h},t.walk=function(e,i){for(var n,a=0,o=e.length;o>a;a++)n=t.codegen[e[a].tag],n&&n(e[a],i);return i},t.parse=function(t,e,i){return i=i||{},a(t,"",[],i.sectionTags||[])},t.cache={},t.cacheKey=function(t,e){return[t,!!e.asString,!!e.disableLambda,e.delimiters,!!e.modelGet].join("||")},t.compile=function(e,i){i=i||{};var n=t.cacheKey(e,i),a=this.cache[n];if(a){var o=a.partials;for(var r in o)delete o[r].instance;return a}return a=this.generate(this.parse(this.scan(e,i.delimiters),e,i),e,i),this.cache[n]=a}}("undefined"!=typeof exports?exports:Hogan),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return t.formatLink(),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){{var t=this;t.el}},formatLink:function(){var e=this,i=e.el,n=i.attr("data-weiboAppkey"),a=encodeURIComponent(i.attr("data-title")),o=encodeURIComponent(i.attr("data-url")),r=encodeURIComponent(i.attr("data-pic"));i.find(".iconfont:not(.favor)").each(function(){var e=t(this),i=e.attr("href");e.hasClass("icon-weibo")&&e.attr("href",i+"?title="+a+"&url="+o+"&pic="+r+"&appkey="+n),e.hasClass("icon-tengxunweibo")&&e.attr("href",i+"?c=share&a=index&title="+a+"&url="+o+"&pic="+r),e.hasClass("icon-kongjian")&&e.attr("href",i+"?title="+a+"&url="+o+"&pics="+r+"&summary="),e.hasClass("icon-douban")&&e.attr("href",i+"?name="+a+"&href="+o+"&image="+r+"&text="+a),e.hasClass("icon-linkedin")&&e.attr("href",i+"?mini=true&ro=true&title="+a+"&url="+o+"&summary=&source=&armin=armin")})}},t.fn.Share=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(jQuery,window,document),function(t,e){var i=Hogan.compile('{{#makemoney}}                                            <a href="{{redirect_url}}" class="makemoney">                                                {{#feedback_url}}<img class="hidden" src="{{feedback_url}}">{{/feedback_url}}                                                <img src="{{image_url}}" alt="{{image_title}}">                                            </a>                                            {{/makemoney}}'),n=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};n.prototype={init:function(){var i=this,n=i.el;return n.find(".com-share").Share(),t.fn.utils.smartDate(n.find(".smart-date")),i.initMakemoney(),i.resetPaper(),i.resizeCategoryTags(),i.bindEvents(),e.COMS=e.COMS||[],n.attr("data-initialized","true"),n.attr("data-guid",e.COMS.length),e.COMS.push(i),i},bindEvents:function(){{var t=this;t.el}},resetPaper:function(){var e=this,i=e.el;i.hasClass("hollywood")&&t.each(i.find(".item.paper"),function(e,i){var n,a,o,r,s=t(i);s&&s.length&&s.attr("data-publishDate")&&(n=new Date,a=new Date(s.attr("data-publishDate").replace(/-/g,"/")),o=Math.round((n.getTime()-a.getTime())/6e4),r=!1,o<=60*n.getHours()&&(r=!0),r||(s.find(".count").removeClass("new"),s.find(".count .text").text("\u4eba\u5df2\u53c2\u52a0"),s.find(".count .num").removeClass("hidden")))})},resizeCategoryTags:function(){for(var t=this,e=t.el,i=e.find(".category-tags"),n=i.find(".category"),a=i.find(".tags"),o=i.outerWidth(!0),r=a.outerWidth(!0),s=n.outerWidth(!0);r>o/2&&a.find(".tag").length;)a.find(".tag:last").remove(),r=a.outerWidth(!0);for(;s+r>o&&a.find(".tag").length;)a.find(".tag:last").remove(),r=a.outerWidth(!0);a.show()},initMakemoney:function(){var e,n,a,o,r=this,s=r.el;t.ajax({url:"/mobile/mount_details/mobile/"+s.attr("data-categoryId")+".json",type:"GET",dataType:"json",data:{},success:function(t){if(t&&t.status){var r=t.data;if(r.top&&r.top.length){for(a=0,o=r.top.length;o>a;a++)r.top[a].redirect_url=r.top[a].redirect_url||"javascript:void(0);";e=i.render({makemoney:r.top}),s.find(".article-detail-hd .category-tags").before(e)}if(r.bottom&&r.bottom.length){for(a=0,o=r.bottom.length;o>a;a++)r.bottom[a].redirect_url=r.bottom[a].redirect_url||"javascript:void(0);";n=i.render({makemoney:r.bottom}),s.find(".article-detail-ft .share-wrapper").before(n)}}},error:function(){}})}},t.fn.ArticleDetail=function(e){var i;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(i=new n(a,e),i.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return t.smartTime(),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){var e=this,i=e.el;i.on("click",".guoqing-detail-hd .reporter-portrait",function(e){e.preventDefault();var n=t(e.currentTarget),a=i.find(".guoqing-detail-bd .articles-wrapper .articles"),o=i.find(".guoqing-detail-hd .reporters .reporter-portrait"),r=i.find(".guoqing-detail-hd .banner .animation"),s=i.find(".guoqing-detail-bd .imgcover.triangle"),l=2,c=n.index()%l,u=["left","right"];o.removeClass("selected"),o.eq(c).addClass("selected"),s.removeClass("left right").addClass(u[c]),a.removeClass("selected"),a.eq(c).addClass("selected"),r.removeClass("animate"),r.eq(c).addClass("animate")})},smartTime:function(){var e=this,i=e.el,n=i.find(".guoqing-detail-bd .smart-time");n.each(function(){var e,i,n=t(this),e=new Date(n.attr("data-publishDate").replace(/-/g,"/")),a=new Date,o=e.getHours(),r=e.getMinutes(),s=!1,l=!1,c=!1;r=10>r?"0"+r:r,i=Math.round((a.getTime()-e.getTime())/6e4),a.getFullYear()-e.getFullYear()>=1?c=!0:a.getDate()-e.getDate()==1?l=!0:i<=60*a.getHours()&&(s=!0),n.text(s?"\u4eca\u5929 \xb7 "+o+":"+r:l?"\u6628\u5929 \xb7 "+o+":"+r:c?e.getFullYear()+"\u5e74"+(e.getMonth()+1)+"\u6708"+e.getDate()+"\u65e5 \xb7 "+o+":"+r:e.getMonth()+1+"\u6708"+e.getDate()+"\u65e5 \xb7 "+o+":"+r)})}},t.fn.GuoqingDetail=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-guid",e.COMS.length),i.attr("data-initialized","true"),e.COMS.push(t),t},bindEvents:function(){{var t=this;t.el}},setStatus:function(t){var e=this,i=e.el;t=t||"loading","stop"==t?i.removeClass("loading"):"vhidden"==t?(i.removeClass("loading"),i.css("visibility","hidden")):i.addClass("loading")}},t.fn.Loader=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=0,n=!1,a=function(i,n){this.el=i,this.defaults={elScrollWrapper:t(e),prefetch:!1,baseUrl:"",commentType:"article",elCommentsContainer:i.find(".items.comments")},this.options=t.extend({},this.defaults,n)};a.prototype={init:function(){var i=this,n=i.el;return i.options.prefetch&&i.fetchComments(),n.find(".com-loader").Loader(),t(".com-comment-popup").CommentPopup(),i.bindEvents(),e.COMS=e.COMS||[],n.attr("data-initialized","true"),n.attr("data-guid",e.COMS.length),e.COMS.push(i),i},bindEvents:function(){var i=this,a=i.el,o=i.options.elScrollWrapper;o.on("scroll",function(){if(!n){var a=t(e).scrollTop(),o=t(e).height(),r=i.options.elCommentsContainer.height(),s=i.options.elCommentsContainer.offset().top,l=120;a+o+l>=s+r&&i.fetchComments()}}),a.delegate(".com-comment .icon-praise","click",function(e){e.preventDefault();var i=t(e.currentTarget),n=i.parents(i.parents(".com-reply").length?".com-reply":".com-comment"),a=n.attr("data-commentId"),o="Qdaily.comment_"+a+".isMarked",r=localStorage.getItem(o)?!0:!1;t.ajax({url:"/mobile/praises/create_praise",type:"POST",dataType:"json",data:{id:a,praise_type:"comment",genre:r?2:1},success:function(e){if(e&&e.status){var n=e.data;r?(localStorage.removeItem(o),i.removeClass("marked")):(localStorage.setItem(o,"true"),i.addClass("marked")),i.text(n.praise_count||"")}else t.fn.utils.showNotification(e.message)},error:function(e){var i=e.responseJSON||{};t.fn.utils.showNotification(i.error)}})}),a.delegate(".com-comment .icon-message","click",function(e){e.preventDefault();var n=t(e.currentTarget),o=n.parents(n.parents(".com-reply").length?".com-reply":".com-comment"),r=o.attr("data-commentId")||0,s=o.find(".name-date:eq(0) .name").text();t.fn.utils.getComponentInstance(t(".com-comment-popup")).openPopup({comment_type:i.options.commentType,id:a.attr("data-id"),parent_id:r,placeholder:"\u56de\u590d"+s})})},autoMark:function(e){{var i=this;i.el}e.filter(".com-comment").each(function(){var e=t(this),i=e.attr("data-commentId");localStorage.getItem("Qdaily.comment_"+i+".isMarked")&&e.find(".name-date:eq(0) .icon-praise").addClass("marked"),e.find(".com-reply").each(function(){var e=t(this),i=e.attr("data-commentId");localStorage.getItem("Qdaily.comment_"+i+".isMarked")&&e.find(".name-date:eq(0) .icon-praise").addClass("marked")})})},validateCommentForm:function(){var e,i=this,n=i.el,a=n.find(".comment-form");return e=a.find('[name="content"]').val(),e?!0:(t.fn.utils.showNotification("\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u8bf7\u8bf4\u70b9\u4ec0\u4e48..."),!1)},validateReplyForm:function(){var e,i=this,n=i.el,a=n.find(".reply-form");return e=a.find('[name="content"]').val(),e?!0:(t.fn.utils.showNotification("\u56de\u590d\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u8bf7\u8bf4\u70b9\u4ec0\u4e48..."),!1)},updateCount:function(t){var e=this,i=e.el;t?(i.removeClass("hidden"),i.find(".count").css({visibility:"visible"}).text(t+"\u6761\u8bc4\u8bba")):i.addClass("hidden")},addComment:function(e){var i=this,n=i.el,a=t(e.html);if(t.fn.utils.smartDate(a.find(".smart-date")),e.parent_id){var o=n.find('[data-commentId="'+e.parent_id+'"]');o.hasClass("com-reply")?o=o.parents(".com-comment"):o.find(".name-date:eq(0) .icon-message").text(e.reply_count||""),o.find(".replies").append(a)}else n.find(".items.comments").prepend(a);i.updateCount(e.total)},fetchComments:function(){if(!n){var e,a=this,o=a.el,r=a.options.baseUrl,s=a.options.elCommentsContainer;n=!0,t.ajax({url:r+"/"+i+".json",type:"GET",dataType:"json",data:{},success:function(r){if(r&&r.status){var l=r.data,c=t(l.html);t.fn.utils.smartDate(c.find(".smart-date")),a.autoMark(c),s.append(c),a.updateCount(l.total),l.last_key?(i=l.last_key,n=!1):(e=t.fn.utils.getComponentInstance(o.find(".com-loader")),e&&e.setStatus("vhidden"))}},error:function(){}})}}},t.fn.RelatedComments=function(e){var i;return this.each(function(){var n=t(this);"true"!=n.attr("data-initialized")&&(i=new a(n,e),i.init())})}}(window.jQuery||window.Zepto,window,document),/*!
 * Packery PACKAGED v1.4.1
 * bin-packing layout library
 *
 * Licensed GPLv3 for open source use
 * or Flickity Commercial License for commercial use
 *
 * http://packery.metafizzy.co
 * Copyright 2015 Metafizzy
 */
function(t){function e(){}function i(t){function i(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}function a(e,i){t.fn[e]=function(a){if("string"==typeof a){for(var r=n.call(arguments,1),s=0,l=this.length;l>s;s++){var c=this[s],u=t.data(c,e);if(u)if(t.isFunction(u[a])&&"_"!==a.charAt(0)){var d=u[a].apply(u,r);if(void 0!==d)return d}else o("no such method '"+a+"' for "+e+" instance");else o("cannot call methods on "+e+" prior to initialization; attempted to call '"+a+"'")}return this}return this.each(function(){var n=t.data(this,e);n?(n.option(a),n._init()):(n=new i(this,a),t.data(this,e,n))})}}if(t){var o="undefined"==typeof console?e:function(t){console.error(t)};return t.bridget=function(t,e){i(e),a(t,e)},t.bridget}}var n=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],i):i("object"==typeof exports?require("jquery"):t.jQuery)}(window),function(t){function e(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function i(t,e){var i=n(t,e)?o:a;i(t,e)}var n,a,o;"classList"in document.documentElement?(n=function(t,e){return t.classList.contains(e)},a=function(t,e){t.classList.add(e)},o=function(t,e){t.classList.remove(e)}):(n=function(t,i){return e(i).test(t.className)},a=function(t,e){n(t,e)||(t.className=t.className+" "+e)},o=function(t,i){t.className=t.className.replace(e(i)," ")});var r={hasClass:n,addClass:a,removeClass:o,toggleClass:i,has:n,add:a,remove:o,toggle:i};"function"==typeof define&&define.amd?define("classie/classie",r):"object"==typeof exports?module.exports=r:t.classie=r}(window),function(t){function e(t){if(t){if("string"==typeof n[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,a=0,o=i.length;o>a;a++)if(e=i[a]+t,"string"==typeof n[e])return e}}var i="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:t.getStyleProperty=e}(window),function(t){function e(t){var e=parseFloat(t),i=-1===t.indexOf("%")&&!isNaN(e);return i&&e}function i(){}function n(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,i=r.length;i>e;e++){var n=r[e];t[n]=0}return t}function a(i){function a(){if(!h){h=!0;var n=t.getComputedStyle;if(c=function(){var t=n?function(t){return n(t,null)}:function(t){return t.currentStyle};return function(e){var i=t(e);return i||o("Style returned "+i+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),i}}(),u=i("boxSizing")){var a=document.createElement("div");a.style.width="200px",a.style.padding="1px 2px 3px 4px",a.style.borderStyle="solid",a.style.borderWidth="1px 2px 3px 4px",a.style[u]="border-box";var r=document.body||document.documentElement;r.appendChild(a);var s=c(a);d=200===e(s.width),r.removeChild(a)}}}function s(t){if(a(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var i=c(t);if("none"===i.display)return n();var o={};o.width=t.offsetWidth,o.height=t.offsetHeight;for(var s=o.isBorderBox=!(!u||!i[u]||"border-box"!==i[u]),h=0,p=r.length;p>h;h++){var f=r[h],m=i[f];m=l(t,m);var g=parseFloat(m);o[f]=isNaN(g)?0:g}var v=o.paddingLeft+o.paddingRight,y=o.paddingTop+o.paddingBottom,w=o.marginLeft+o.marginRight,b=o.marginTop+o.marginBottom,x=o.borderLeftWidth+o.borderRightWidth,C=o.borderTopWidth+o.borderBottomWidth,S=s&&d,k=e(i.width);k!==!1&&(o.width=k+(S?0:v+x));var T=e(i.height);return T!==!1&&(o.height=T+(S?0:y+C)),o.innerWidth=o.width-(v+x),o.innerHeight=o.height-(y+C),o.outerWidth=o.width+w,o.outerHeight=o.height+b,o}}function l(e,i){if(t.getComputedStyle||-1===i.indexOf("%"))return i;var n=e.style,a=n.left,o=e.runtimeStyle,r=o&&o.left;return r&&(o.left=e.currentStyle.left),n.left=i,i=n.pixelLeft,n.left=a,r&&(o.left=r),i}var c,u,d,h=!1;return s}var o="undefined"==typeof console?i:function(t){console.error(t)},r=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],a):"object"==typeof exports?module.exports=a(require("desandro-get-style-property")):t.getSize=a(t.getStyleProperty)}(window),function(t){function e(e){var i=t.event;return i.target=i.target||i.srcElement||e,i}var i=document.documentElement,n=function(){};i.addEventListener?n=function(t,e,i){t.addEventListener(e,i,!1)}:i.attachEvent&&(n=function(t,i,n){t[i+n]=n.handleEvent?function(){var i=e(t);n.handleEvent.call(n,i)}:function(){var i=e(t);n.call(t,i)},t.attachEvent("on"+i,t[i+n])});var a=function(){};i.removeEventListener?a=function(t,e,i){t.removeEventListener(e,i,!1)}:i.detachEvent&&(a=function(t,e,i){t.detachEvent("on"+e,t[e+i]);try{delete t[e+i]}catch(n){t[e+i]=void 0}});var o={bind:n,unbind:a};"function"==typeof define&&define.amd?define("eventie/eventie",o):"object"==typeof exports?module.exports=o:t.eventie=o}(window),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,a=this,o=a.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,a=this.getListenersAsObject(t),o="object"==typeof i;for(n in a)a.hasOwnProperty(n)&&-1===e(a[n],i)&&a[n].push(o?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,a,o=this.getListenersAsObject(t);for(a in o)o.hasOwnProperty(a)&&(n=e(o[a],i),-1!==n&&o[a].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,a,o=t?this.removeListener:this.addListener,r=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)o.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(a=e[n])&&("function"==typeof a?o.call(this,n,a):r.call(this,n,a));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){var i,n,a,o,r=this.getListenersAsObject(t);for(a in r)if(r.hasOwnProperty(a))for(n=r[a].length;n--;)i=r[a][n],i.once===!0&&this.removeListener(t,i.listener),o=i.listener.apply(this,e||[]),o===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return a.EventEmitter=o,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:a.EventEmitter=t}.call(this),function(t){function e(t){"function"==typeof t&&(e.isReady?t():r.push(t))}function i(t){var i="readystatechange"===t.type&&"complete"!==o.readyState;e.isReady||i||n()}function n(){e.isReady=!0;for(var t=0,i=r.length;i>t;t++){var n=r[t];n()}}function a(a){return"complete"===o.readyState?n():(a.bind(o,"DOMContentLoaded",i),a.bind(o,"readystatechange",i),a.bind(t,"load",i)),e}var o=t.document,r=[];e.isReady=!1,"function"==typeof define&&define.amd?define("doc-ready/doc-ready",["eventie/eventie"],a):"object"==typeof exports?module.exports=a(require("eventie")):t.docReady=a(t.eventie)}(window),function(t){function e(t,e){return t[r](e)}function i(t){if(!t.parentNode){var e=document.createDocumentFragment();e.appendChild(t)}}function n(t,e){i(t);for(var n=t.parentNode.querySelectorAll(e),a=0,o=n.length;o>a;a++)if(n[a]===t)return!0;return!1}function a(t,n){return i(t),e(t,n)}var o,r=function(){if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0,n=e.length;n>i;i++){var a=e[i],o=a+"MatchesSelector";if(t[o])return o}}();if(r){var s=document.createElement("div"),l=e(s,"div");o=l?e:a}else o=n;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return o}):"object"==typeof exports?module.exports=o:window.matchesSelector=o}(Element.prototype),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["doc-ready/doc-ready","matches-selector/matches-selector"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("doc-ready"),require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.docReady,t.matchesSelector)}(window,function(t,e,i){var n={};n.extend=function(t,e){for(var i in e)t[i]=e[i];return t},n.modulo=function(t,e){return(t%e+e)%e};var a=Object.prototype.toString;n.isArray=function(t){return"[object Array]"==a.call(t)},n.makeArray=function(t){var e=[];if(n.isArray(t))e=t;else if(t&&"number"==typeof t.length)for(var i=0,a=t.length;a>i;i++)e.push(t[i]);else e.push(t);return e},n.indexOf=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},n.removeFrom=function(t,e){var i=n.indexOf(t,e);-1!=i&&t.splice(i,1)},n.isElement="function"==typeof HTMLElement||"object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1==t.nodeType&&"string"==typeof t.nodeName},n.setText=function(){function t(t,i){e=e||(void 0!==document.documentElement.textContent?"textContent":"innerText"),t[e]=i}var e;return t}(),n.getParent=function(t,e){for(;t!=document.body;)if(t=t.parentNode,i(t,e))return t},n.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.filterFindElements=function(t,e){t=n.makeArray(t);for(var a=[],o=0,r=t.length;r>o;o++){var s=t[o];if(n.isElement(s))if(e){i(s,e)&&a.push(s);for(var l=s.querySelectorAll(e),c=0,u=l.length;u>c;c++)a.push(l[c])}else a.push(s)}return a},n.debounceMethod=function(t,e,i){var n=t.prototype[e],a=e+"Timeout";t.prototype[e]=function(){var t=this[a];t&&clearTimeout(t);var e=arguments,o=this;this[a]=setTimeout(function(){n.apply(o,e),delete o[a]},i||100)}},n.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var o=t.console;return n.htmlInit=function(i,a){e(function(){for(var e=n.toDashed(a),r=document.querySelectorAll(".js-"+e),s="data-"+e+"-options",l=0,c=r.length;c>l;l++){var u,d=r[l],h=d.getAttribute(s);try{u=h&&JSON.parse(h)}catch(p){o&&o.error("Error parsing "+s+" on "+d.nodeName.toLowerCase()+(d.id?"#"+d.id:"")+": "+p);continue}var f=new i(d,u),m=t.jQuery;m&&m.data(d,a,f)}})},n}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property","fizzy-ui-utils/utils"],function(i,n,a,o){return e(t,i,n,a,o)}):"object"==typeof exports?module.exports=e(t,require("wolfy87-eventemitter"),require("get-size"),require("desandro-get-style-property"),require("fizzy-ui-utils")):(t.Outlayer={},t.Outlayer.Item=e(t,t.EventEmitter,t.getSize,t.getStyleProperty,t.fizzyUIUtils))}(window,function(t,e,i,n,a){function o(t){for(var e in t)return!1;return e=null,!0}function r(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var s=t.getComputedStyle,l=s?function(t){return s(t,null)}:function(t){return t.currentStyle},c=n("transition"),u=n("transform"),d=c&&u,h=!!n("perspective"),p={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[c],f=["transform","transition","transitionDuration","transitionProperty"],m=function(){for(var t={},e=0,i=f.length;i>e;e++){var a=f[e],o=n(a);o&&o!==a&&(t[a]=o)}return t}();a.extend(r.prototype,e.prototype),r.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},r.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.prototype.getSize=function(){this.size=i(this.element)},r.prototype.css=function(t){var e=this.element.style;for(var i in t){var n=m[i]||i;e[n]=t[i]}},r.prototype.getPosition=function(){var t=l(this.element),e=this.layout.options,i=e.isOriginLeft,n=e.isOriginTop,a=parseInt(t[i?"left":"right"],10),o=parseInt(t[n?"top":"bottom"],10);a=isNaN(a)?0:a,o=isNaN(o)?0:o;var r=this.layout.size;a-=i?r.paddingLeft:r.paddingRight,o-=n?r.paddingTop:r.paddingBottom,this.position.x=a,this.position.y=o},r.prototype.layoutPosition=function(){var t=this.layout.size,e=this.layout.options,i={},n=e.isOriginLeft?"paddingLeft":"paddingRight",a=e.isOriginLeft?"left":"right",o=e.isOriginLeft?"right":"left",r=this.position.x+t[n];r=e.percentPosition&&!e.isHorizontal?r/t.width*100+"%":r+"px",i[a]=r,i[o]="";var s=e.isOriginTop?"paddingTop":"paddingBottom",l=e.isOriginTop?"top":"bottom",c=e.isOriginTop?"bottom":"top",u=this.position.y+t[s];u=e.percentPosition&&e.isHorizontal?u/t.height*100+"%":u+"px",i[l]=u,i[c]="",this.css(i),this.emitEvent("layout",[this])};var g=h?function(t,e){return"translate3d("+t+"px, "+e+"px, 0)"}:function(t,e){return"translate("+t+"px, "+e+"px)"};r.prototype._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,a=parseInt(t,10),o=parseInt(e,10),r=a===this.position.x&&o===this.position.y;if(this.setPosition(t,e),r&&!this.isTransitioning)return void this.layoutPosition();var s=t-i,l=e-n,c={},u=this.layout.options;s=u.isOriginLeft?s:-s,l=u.isOriginTop?l:-l,c.transform=g(s,l),this.transition({to:c,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},r.prototype.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},r.prototype.moveTo=d?r.prototype._transitionTo:r.prototype.goTo,r.prototype.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},r.prototype._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},r.prototype._transition=function(t){if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(t);var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);var n=this.element.offsetHeight;n=null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0};var v=u&&a.toDashed(u)+",opacity";r.prototype.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:v,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(p,this,!1))},r.prototype.transition=r.prototype[c?"_transition":"_nonTransition"],r.prototype.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},r.prototype.onotransitionend=function(t){this.ontransitionend(t)};var y={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};r.prototype.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,i=y[t.propertyName]||t.propertyName;if(delete e.ingProperties[i],o(e.ingProperties)&&this.disableTransition(),i in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[i]),i in e.onEnd){var n=e.onEnd[i];n.call(this),delete e.onEnd[i]}this.emitEvent("transitionEnd",[this])}},r.prototype.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(p,this,!1),this.isTransitioning=!1},r.prototype._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var w={transitionProperty:"",transitionDuration:""};return r.prototype.removeTransitionStyles=function(){this.css(w)},r.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},r.prototype.remove=function(){if(!c||!parseFloat(this.layout.options.transitionDuration))return void this.removeElem();var t=this;this.once("transitionEnd",function(){t.removeElem()}),this.hide()},r.prototype.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("visibleStyle");e[i]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},r.prototype.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},r.prototype.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var i in e)return i},r.prototype.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("hiddenStyle");e[i]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},r.prototype.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},r.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},r}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","eventEmitter/EventEmitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,n,a,o,r){return e(t,i,n,a,o,r)}):"object"==typeof exports?module.exports=e(t,require("eventie"),require("wolfy87-eventemitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.eventie,t.EventEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item)}(window,function(t,e,i,n,a,o){function r(t,e){var i=a.getQueryElement(t);if(!i)return void(s&&s.error("Bad element for "+this.constructor.namespace+": "+(i||t)));this.element=i,l&&(this.$element=l(this.element)),this.options=a.extend({},this.constructor.defaults),this.option(e);var n=++u;this.element.outlayerGUID=n,d[n]=this,this._create(),this.options.isInitLayout&&this.layout()}var s=t.console,l=t.jQuery,c=function(){},u=0,d={};return r.namespace="outlayer",r.Item=o,r.defaults={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,isResizingContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},a.extend(r.prototype,i.prototype),r.prototype.option=function(t){a.extend(this.options,t)},r.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),a.extend(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},r.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},r.prototype._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],a=0,o=e.length;o>a;a++){var r=e[a],s=new i(r,this);n.push(s)}return n},r.prototype._filterFindItemElements=function(t){return a.filterFindElements(t,this.options.itemSelector)},r.prototype.getItemElements=function(){for(var t=[],e=0,i=this.items.length;i>e;e++)t.push(this.items[e].element);return t},r.prototype.layout=function(){this._resetLayout(),this._manageStamps();var t=void 0!==this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,t),this._isLayoutInited=!0},r.prototype._init=r.prototype.layout,r.prototype._resetLayout=function(){this.getSize()},r.prototype.getSize=function(){this.size=n(this.element)},r.prototype._getMeasurement=function(t,e){var i,o=this.options[t];o?("string"==typeof o?i=this.element.querySelector(o):a.isElement(o)&&(i=o),this[t]=i?n(i)[e]:o):this[t]=0},r.prototype.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},r.prototype._getItemsForLayout=function(t){for(var e=[],i=0,n=t.length;n>i;i++){var a=t[i];a.isIgnored||e.push(a)}return e},r.prototype._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){for(var i=[],n=0,a=t.length;a>n;n++){var o=t[n],r=this._getItemLayoutPosition(o);r.item=o,r.isInstant=e||o.isLayoutInstant,i.push(r)}this._processLayoutQueue(i)}},r.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},r.prototype._processLayoutQueue=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];this._positionItem(n.item,n.x,n.y,n.isInstant)}},r.prototype._positionItem=function(t,e,i,n){n?t.goTo(e,i):t.moveTo(e,i)},r.prototype._postLayout=function(){this.resizeContainer()},r.prototype.resizeContainer=function(){if(this.options.isResizingContainer){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},r.prototype._getContainerSize=c,r.prototype._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},r.prototype._emitCompleteOnItems=function(t,e){function i(){a.emitEvent(t+"Complete",[e])}function n(){r++,r===o&&i()}var a=this,o=e.length;if(!e||!o)return void i();for(var r=0,s=0,l=e.length;l>s;s++){var c=e[s];c.once(t,n)}},r.prototype.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},r.prototype.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},r.prototype.stamp=function(t){if(t=this._find(t)){this.stamps=this.stamps.concat(t);for(var e=0,i=t.length;i>e;e++){var n=t[e];this.ignore(n)}}},r.prototype.unstamp=function(t){if(t=this._find(t))for(var e=0,i=t.length;i>e;e++){var n=t[e];a.removeFrom(this.stamps,n),this.unignore(n)}},r.prototype._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=a.makeArray(t)):void 0},r.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var t=0,e=this.stamps.length;e>t;t++){var i=this.stamps[t];this._manageStamp(i)}}},r.prototype._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},r.prototype._manageStamp=c,r.prototype._getElementOffset=function(t){var e=t.getBoundingClientRect(),i=this._boundingRect,a=n(t),o={left:e.left-i.left-a.marginLeft,top:e.top-i.top-a.marginTop,right:i.right-e.right-a.marginRight,bottom:i.bottom-e.bottom-a.marginBottom};return o},r.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.prototype.bindResize=function(){this.isResizeBound||(e.bind(t,"resize",this),this.isResizeBound=!0)},r.prototype.unbindResize=function(){this.isResizeBound&&e.unbind(t,"resize",this),this.isResizeBound=!1},r.prototype.onresize=function(){function t(){e.resize(),delete e.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var e=this;this.resizeTimeout=setTimeout(t,100)},r.prototype.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},r.prototype.needsResizeLayout=function(){var t=n(this.element),e=this.size&&t;return e&&t.innerWidth!==this.size.innerWidth},r.prototype.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},r.prototype.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},r.prototype.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},r.prototype.reveal=function(t){this._emitCompleteOnItems("reveal",t);for(var e=t&&t.length,i=0;e&&e>i;i++){var n=t[i];n.reveal()}},r.prototype.hide=function(t){this._emitCompleteOnItems("hide",t);for(var e=t&&t.length,i=0;e&&e>i;i++){var n=t[i];n.hide()}},r.prototype.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},r.prototype.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},r.prototype.getItem=function(t){for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];if(n.element===t)return n}},r.prototype.getItems=function(t){t=a.makeArray(t);for(var e=[],i=0,n=t.length;n>i;i++){var o=t[i],r=this.getItem(o);r&&e.push(r)}return e},r.prototype.remove=function(t){var e=this.getItems(t);if(this._emitCompleteOnItems("remove",e),e&&e.length)for(var i=0,n=e.length;n>i;i++){var o=e[i];o.remove(),a.removeFrom(this.items,o)}},r.prototype.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="";for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];n.destroy()}this.unbindResize();var a=this.element.outlayerGUID;delete d[a],delete this.element.outlayerGUID,l&&l.removeData(this.element,this.constructor.namespace)},r.data=function(t){t=a.getQueryElement(t);var e=t&&t.outlayerGUID;return e&&d[e]},r.create=function(t,e){function i(){r.apply(this,arguments)}return Object.create?i.prototype=Object.create(r.prototype):a.extend(i.prototype,r.prototype),i.prototype.constructor=i,i.defaults=a.extend({},r.defaults),a.extend(i.defaults,e),i.prototype.settings={},i.namespace=t,i.data=r.data,i.Item=function(){o.apply(this,arguments)},i.Item.prototype=new o,a.htmlInit(i,t),l&&l.bridget&&l.bridget(t,i),i},r.Item=o,r}),function(t,e){"function"==typeof define&&define.amd?define("packery/js/rect",e):"object"==typeof exports?module.exports=e():(t.Packery=t.Packery||{},t.Packery.Rect=e())}(window,function(){function t(e){for(var i in t.defaults)this[i]=t.defaults[i];for(i in e)this[i]=e[i]}var e=window.Packery=function(){};return e.Rect=t,t.defaults={x:0,y:0,width:0,height:0},t.prototype.contains=function(t){var e=t.width||0,i=t.height||0;return this.x<=t.x&&this.y<=t.y&&this.x+this.width>=t.x+e&&this.y+this.height>=t.y+i},t.prototype.overlaps=function(t){var e=this.x+this.width,i=this.y+this.height,n=t.x+t.width,a=t.y+t.height;return this.x<n&&e>t.x&&this.y<a&&i>t.y},t.prototype.getMaximalFreeRects=function(e){if(!this.overlaps(e))return!1;var i,n=[],a=this.x+this.width,o=this.y+this.height,r=e.x+e.width,s=e.y+e.height;return this.y<e.y&&(i=new t({x:this.x,y:this.y,width:this.width,height:e.y-this.y}),n.push(i)),a>r&&(i=new t({x:r,y:this.y,width:a-r,height:this.height}),n.push(i)),o>s&&(i=new t({x:this.x,y:s,width:this.width,height:o-s}),n.push(i)),this.x<e.x&&(i=new t({x:this.x,y:this.y,width:e.x-this.x,height:this.height}),n.push(i)),n},t.prototype.canFit=function(t){return this.width>=t.width&&this.height>=t.height},t}),function(t,e){if("function"==typeof define&&define.amd)define("packery/js/packer",["./rect"],e);else if("object"==typeof exports)module.exports=e(require("./rect"));else{var i=t.Packery=t.Packery||{};i.Packer=e(i.Rect)}}(window,function(t){function e(t,e,i){this.width=t||0,this.height=e||0,this.sortDirection=i||"downwardLeftToRight",this.reset()}e.prototype.reset=function(){this.spaces=[],this.newSpaces=[];var e=new t({x:0,y:0,width:this.width,height:this.height});this.spaces.push(e),this.sorter=i[this.sortDirection]||i.downwardLeftToRight},e.prototype.pack=function(t){for(var e=0,i=this.spaces.length;i>e;e++){var n=this.spaces[e];if(n.canFit(t)){this.placeInSpace(t,n);break}}},e.prototype.placeInSpace=function(t,e){t.x=e.x,t.y=e.y,this.placed(t)},e.prototype.placed=function(t){for(var e=[],i=0,n=this.spaces.length;n>i;i++){var a=this.spaces[i],o=a.getMaximalFreeRects(t);o?e.push.apply(e,o):e.push(a)}this.spaces=e,this.mergeSortSpaces()},e.prototype.mergeSortSpaces=function(){e.mergeRects(this.spaces),this.spaces.sort(this.sorter)},e.prototype.addSpace=function(t){this.spaces.push(t),this.mergeSortSpaces()},e.mergeRects=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(n){var a=t.slice(0);a.splice(e,1);for(var o=0,r=0,s=a.length;s>r;r++){var l=a[r],c=e>r?0:1;n.contains(l)&&(t.splice(r+c-o,1),o++)}}}return t};var i={downwardLeftToRight:function(t,e){return t.y-e.y||t.x-e.x},rightwardTopToBottom:function(t,e){return t.x-e.x||t.y-e.y}};return e}),function(t,e){"function"==typeof define&&define.amd?define("packery/js/item",["get-style-property/get-style-property","outlayer/outlayer","./rect"],e):"object"==typeof exports?module.exports=e(require("desandro-get-style-property"),require("outlayer"),require("./rect")):t.Packery.Item=e(t.getStyleProperty,t.Outlayer,t.Packery.Rect)}(window,function(t,e,i){var n=t("transform"),a=function(){e.Item.apply(this,arguments)};a.prototype=new e.Item;var o=a.prototype._create;return a.prototype._create=function(){o.call(this),this.rect=new i,this.placeRect=new i},a.prototype.dragStart=function(){this.getPosition(),this.removeTransitionStyles(),this.isTransitioning&&n&&(this.element.style[n]="none"),this.getSize(),this.isPlacing=!0,this.needsPositioning=!1,this.positionPlaceRect(this.position.x,this.position.y),this.isTransitioning=!1,this.didDrag=!1},a.prototype.dragMove=function(t,e){this.didDrag=!0;var i=this.layout.size;t-=i.paddingLeft,e-=i.paddingTop,this.positionPlaceRect(t,e)},a.prototype.dragStop=function(){this.getPosition();var t=this.position.x!=this.placeRect.x,e=this.position.y!=this.placeRect.y;this.needsPositioning=t||e,this.didDrag=!1},a.prototype.positionPlaceRect=function(t,e,i){this.placeRect.x=this.getPlaceRectCoord(t,!0),this.placeRect.y=this.getPlaceRectCoord(e,!1,i)},a.prototype.getPlaceRectCoord=function(t,e,i){var n=e?"Width":"Height",a=this.size["outer"+n],o=this.layout[e?"columnWidth":"rowHeight"],r=this.layout.size["inner"+n];e||(r=Math.max(r,this.layout.maxY),this.layout.rowHeight||(r-=this.layout.gutter));var s;if(o){o+=this.layout.gutter,r+=e?this.layout.gutter:0,t=Math.round(t/o);var l;l=this.layout.options.isHorizontal?e?"ceil":"floor":e?"floor":"ceil";var c=Math[l](r/o);c-=Math.ceil(a/o),s=c}else s=r-a;return t=i?t:Math.min(t,s),t*=o||1,Math.max(0,t)},a.prototype.copyPlaceRectPosition=function(){this.rect.x=this.placeRect.x,this.rect.y=this.placeRect.y},a.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.layout.packer.addSpace(this.rect),this.emitEvent("remove",[this])},a}),/*!
 * Packery v1.4.1
 * bin-packing layout library
 *
 * Licensed GPLv3 for open source use
 * or Flickity Commercial License for commercial use
 *
 * http://packery.metafizzy.co
 * Copyright 2015 Metafizzy
 */
function(t,e){"function"==typeof define&&define.amd?define(["classie/classie","get-size/get-size","outlayer/outlayer","packery/js/rect","packery/js/packer","packery/js/item"],e):"object"==typeof exports?module.exports=e(require("desandro-classie"),require("get-size"),require("outlayer"),require("./rect"),require("./packer"),require("./item")):t.Packery=e(t.classie,t.getSize,t.Outlayer,t.Packery.Rect,t.Packery.Packer,t.Packery.Item)}(window,function(t,e,i,n,a,o){function r(t,e){return t.position.y-e.position.y||t.position.x-e.position.x}function s(t,e){return t.position.x-e.position.x||t.position.y-e.position.y}n.prototype.canFit=function(t){return this.width>=t.width-1&&this.height>=t.height-1};var l=i.create("packery");return l.Item=o,l.prototype._create=function(){i.prototype._create.call(this),this.packer=new a,this.stamp(this.options.stamped);var t=this;this.handleDraggabilly={dragStart:function(){t.itemDragStart(this.element)},dragMove:function(){t.itemDragMove(this.element,this.position.x,this.position.y)},dragEnd:function(){t.itemDragEnd(this.element)}},this.handleUIDraggable={start:function(e){t.itemDragStart(e.currentTarget)},drag:function(e,i){t.itemDragMove(e.currentTarget,i.position.left,i.position.top)},stop:function(e){t.itemDragEnd(e.currentTarget)}}},l.prototype._resetLayout=function(){this.getSize(),this._getMeasurements();var t=this.packer;this.options.isHorizontal?(t.width=Number.POSITIVE_INFINITY,t.height=this.size.innerHeight+this.gutter,t.sortDirection="rightwardTopToBottom"):(t.width=this.size.innerWidth+this.gutter,t.height=Number.POSITIVE_INFINITY,t.sortDirection="downwardLeftToRight"),t.reset(),this.maxY=0,this.maxX=0},l.prototype._getMeasurements=function(){this._getMeasurement("columnWidth","width"),this._getMeasurement("rowHeight","height"),this._getMeasurement("gutter","width")},l.prototype._getItemLayoutPosition=function(t){return this._packItem(t),t.rect},l.prototype._packItem=function(t){this._setRectSize(t.element,t.rect),this.packer.pack(t.rect),this._setMaxXY(t.rect)},l.prototype._setMaxXY=function(t){this.maxX=Math.max(t.x+t.width,this.maxX),this.maxY=Math.max(t.y+t.height,this.maxY)},l.prototype._setRectSize=function(t,i){var n=e(t),a=n.outerWidth,o=n.outerHeight;(a||o)&&(a=this._applyGridGutter(a,this.columnWidth),o=this._applyGridGutter(o,this.rowHeight)),i.width=Math.min(a,this.packer.width),i.height=Math.min(o,this.packer.height)},l.prototype._applyGridGutter=function(t,e){if(!e)return t+this.gutter;e+=this.gutter;var i=t%e,n=i&&1>i?"round":"ceil";return t=Math[n](t/e)*e},l.prototype._getContainerSize=function(){return this.options.isHorizontal?{width:this.maxX-this.gutter}:{height:this.maxY-this.gutter}},l.prototype._manageStamp=function(t){var e,i=this.getItem(t);if(i&&i.isPlacing)e=i.placeRect;else{var a=this._getElementOffset(t);e=new n({x:this.options.isOriginLeft?a.left:a.right,y:this.options.isOriginTop?a.top:a.bottom})}this._setRectSize(t,e),this.packer.placed(e),this._setMaxXY(e)},l.prototype.sortItemsByPosition=function(){var t=this.options.isHorizontal?s:r;this.items.sort(t)},l.prototype.fit=function(t,e,i){var n=this.getItem(t);n&&(this._getMeasurements(),this.stamp(n.element),n.getSize(),n.isPlacing=!0,e=void 0===e?n.rect.x:e,i=void 0===i?n.rect.y:i,n.positionPlaceRect(e,i,!0),this._bindFitEvents(n),n.moveTo(n.placeRect.x,n.placeRect.y),this.layout(),this.unstamp(n.element),this.sortItemsByPosition(),n.isPlacing=!1,n.copyPlaceRectPosition())},l.prototype._bindFitEvents=function(t){function e(){n++,2==n&&i.emitEvent("fitComplete",[t])}var i=this,n=0;t.on("layout",function(){return e(),!0}),this.on("layoutComplete",function(){return e(),!0})},l.prototype.resize=function(){var t=e(this.element),i=this.size&&t,n=this.options.isHorizontal?"innerHeight":"innerWidth";i&&t[n]==this.size[n]||this.layout()},l.prototype.itemDragStart=function(t){this.stamp(t);var e=this.getItem(t);e&&e.dragStart()},l.prototype.itemDragMove=function(t,e,i){function n(){o.layout(),delete o.dragTimeout}var a=this.getItem(t);a&&a.dragMove(e,i);var o=this;this.clearDragTimeout(),this.dragTimeout=setTimeout(n,40)},l.prototype.clearDragTimeout=function(){this.dragTimeout&&clearTimeout(this.dragTimeout)},l.prototype.itemDragEnd=function(e){var i,n=this.getItem(e);if(n&&(i=n.didDrag,n.dragStop()),!n||!i&&!n.needsPositioning)return void this.unstamp(e);t.add(n.element,"is-positioning-post-drag");var a=this._getDragEndLayoutComplete(e,n);n.needsPositioning?(n.on("layout",a),n.moveTo(n.placeRect.x,n.placeRect.y)):n&&n.copyPlaceRectPosition(),this.clearDragTimeout(),this.on("layoutComplete",a),this.layout()},l.prototype._getDragEndLayoutComplete=function(e,i){var n=i&&i.needsPositioning,a=0,o=n?2:1,r=this;return function(){return a++,a!=o?!0:(i&&(t.remove(i.element,"is-positioning-post-drag"),i.isPlacing=!1,i.copyPlaceRectPosition()),r.unstamp(e),r.sortItemsByPosition(),n&&r.emitEvent("dragItemPositioned",[i]),!0)}},l.prototype.bindDraggabillyEvents=function(t){t.on("dragStart",this.handleDraggabilly.dragStart),t.on("dragMove",this.handleDraggabilly.dragMove),t.on("dragEnd",this.handleDraggabilly.dragEnd)},l.prototype.bindUIDraggableEvents=function(t){t.on("dragstart",this.handleUIDraggable.start).on("drag",this.handleUIDraggable.drag).on("dragstop",this.handleUIDraggable.stop)},l.Rect=n,l.Packer=a,l}),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var i=this,n=i.el;return t.fn.utils.smartDate(n.find(".smart-date")),i.bindEvents(),e.COMS=e.COMS||[],n.attr("data-initialized","true"),n.attr("data-guid",e.COMS.length),e.COMS.push(i),i},bindEvents:function(){{var t=this;t.el}}},t.fn.GridArticle=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var i=this,n=i.el;return t.fn.utils.smartDate(n.find(".smart-date")),i.bindEvents(),e.COMS=e.COMS||[],n.attr("data-initialized","true"),n.attr("data-guid",e.COMS.length),e.COMS.push(i),i},bindEvents:function(){{var t=this;t.el}}},t.fn.GridKeyArticle=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return i.find(".com-grid-article").GridArticle({}),i.find(".com-grid-key-article").GridKeyArticle({}),t.initPackery(),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){var e=this,i=e.el;i.on("animationend webkitanimationend mozanimationend msanimationend oanimationend",".packery-item",function(e){e.preventDefault();var i=t(e.currentTarget);i.removeClass("animated fadeIn")})},initPackery:function(){var e=this,i=e.el,n=i.find(".packery-container");n.packery({isInitLayout:!1,itemSelector:".packery-item",stamp:".packery-stamp",gutter:".packery-gutter"}),n.packery("on","layoutComplete",function(e){t.each(e,function(e,i){var n=t(i.element);n.css("visibility","visible"),n.addClass("animated fadeIn")})}),n.packery()}},t.fn.RelatedArticles=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return t.formatCount(),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){{var t=this;t.el}},formatCount:function(){var t,e,i,n=this,a=n.el,o=a.find(".grid-paper-bd .count"),r=!1;o.length&&(e=new Date,t=new Date(o.attr("data-publishDate").replace(/-/g,"/")),i=Math.round((e.getTime()-t.getTime())/6e4),i<=60*e.getHours()&&(r=!0),r&&(o.addClass("new"),o.find(".num").remove(),o.find(".text").text("NEW")),o.find(".num, .text").css("display","block"))}},t.fn.GridPaper=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),/*!
 * Chart.js
 * http://chartjs.org/
 * Version: {{ version }}
 *
 * Copyright 2015 Nick Downie
 * Released under the MIT license
 * https://github.com/nnnick/Chart.js/blob/master/LICENSE.md
 */
function(){"use strict";var t=this,e=t.Chart,i=function(t){this.canvas=t.canvas,this.ctx=t;var e=function(t,e){return t["offset"+e]?t["offset"+e]:document.defaultView.getComputedStyle(t).getPropertyValue(e)},i=this.width=e(t.canvas,"Width")||t.canvas.width,a=this.height=e(t.canvas,"Height")||t.canvas.height;return t.canvas.width=i,t.canvas.height=a,i=this.width=t.canvas.width,a=this.height=t.canvas.height,this.aspectRatio=this.width/this.height,n.retinaScale(this),this};i.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},i.types={};var n=i.helpers={},a=n.each=function(t,e,i){var n=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var a;for(a=0;a<t.length;a++)e.apply(i,[t[a],a].concat(n))}else for(var o in t)e.apply(i,[t[o],o].concat(n))},o=n.clone=function(t){var e={};return a(t,function(i,n){t.hasOwnProperty(n)&&(e[n]=i)}),e},r=n.extend=function(t){return a(Array.prototype.slice.call(arguments,1),function(e){a(e,function(i,n){e.hasOwnProperty(n)&&(t[n]=i)})}),t},s=n.merge=function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift({}),r.apply(null,t)},l=n.indexOf=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},c=(n.where=function(t,e){var i=[];return n.each(t,function(t){e(t)&&i.push(t)}),i},n.findNextWhere=function(t,e,i){i||(i=-1);for(var n=i+1;n<t.length;n++){var a=t[n];if(e(a))return a}},n.findPreviousWhere=function(t,e,i){i||(i=t.length);for(var n=i-1;n>=0;n--){var a=t[n];if(e(a))return a}},n.inherits=function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=c,t&&r(i.prototype,t),i.__super__=e.prototype,i}),u=n.noop=function(){},d=n.uid=function(){var t=0;return function(){return"chart-"+t++}}(),h=n.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},p=n.amd="function"==typeof define&&define.amd,f=n.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},m=n.max=function(t){return Math.max.apply(Math,t)},g=n.min=function(t){return Math.min.apply(Math,t)},v=(n.cap=function(t,e,i){if(f(e)){if(t>e)return e}else if(f(i)&&i>t)return i;return t},n.getDecimalPlaces=function(t){if(t%1!==0&&f(t)){var e=t.toString();if(e.indexOf("e-")<0)return e.split(".")[1].length;if(e.indexOf(".")<0)return parseInt(e.split("e-")[1]);var i=e.split(".")[1].split("e-");return i[0].length+parseInt(i[1])}return 0}),y=n.radians=function(t){return t*(Math.PI/180)},w=(n.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,a=Math.sqrt(i*i+n*n),o=2*Math.PI+Math.atan2(n,i);return 0>i&&0>n&&(o+=2*Math.PI),{angle:o,distance:a}},n.aliasPixel=function(t){return t%2===0?0:.5}),b=(n.splineCurve=function(t,e,i,n){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)),r=n*a/(a+o),s=n*o/(a+o);return{inner:{x:e.x-r*(i.x-t.x),y:e.y-r*(i.y-t.y)},outer:{x:e.x+s*(i.x-t.x),y:e.y+s*(i.y-t.y)}}},n.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),x=(n.calculateScaleRange=function(t,e,i,n,a){var o=2,r=Math.floor(e/(1.5*i)),s=o>=r,l=m(t),c=g(t);l===c&&(l+=.5,c>=.5&&!n?c-=.5:l+=.5);for(var u=Math.abs(l-c),d=b(u),h=Math.ceil(l/(1*Math.pow(10,d)))*Math.pow(10,d),p=n?0:Math.floor(c/(1*Math.pow(10,d)))*Math.pow(10,d),f=h-p,v=Math.pow(10,d),y=Math.round(f/v);(y>r||r>2*y)&&!s;)if(y>r)v*=2,y=Math.round(f/v),y%1!==0&&(s=!0);else if(a&&d>=0){if(v/2%1!==0)break;v/=2,y=Math.round(f/v)}else v/=2,y=Math.round(f/v);return s&&(y=o,v=f/y),{steps:y,stepValue:v,min:p,max:p+y*v}},n.template=function(t,e){function i(t,e){var i=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[t]=n[t];return e?i(e):i}if(t instanceof Function)return t(e);var n={};return i(t,e)}),C=(n.generateLabels=function(t,e,i,n){var o=new Array(e);return t&&a(o,function(e,a){o[a]=x(t,{value:i+n*(a+1)})}),o},n.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-0.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-0.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-0.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1==(t/=1)?1:(i||(i=.3),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i)))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1==(t/=1)?1:(i||(i=.3),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(1*t-e)*Math.PI/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.3*1.5),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-C.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*C.easeInBounce(2*t):.5*C.easeOutBounce(2*t-1)+.5}}),S=n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),k=(n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),n.animationLoop=function(t,e,i,n,a,o){var r=0,s=C[i]||C.linear,l=function(){r++;var i=r/e,c=s(i);t.call(o,c,i,r),n.call(o,c,i),e>r?o.animationFrame=S(l):a.apply(o)};S(l)},n.getRelativePosition=function(t){var e,i,n=t.originalEvent||t,a=t.currentTarget||t.srcElement,o=a.getBoundingClientRect();return n.touches?(e=n.touches[0].clientX-o.left,i=n.touches[0].clientY-o.top):(e=n.clientX-o.left,i=n.clientY-o.top),{x:e,y:i}},n.addEvent=function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}),T=n.removeEvent=function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=u},P=(n.bindEvents=function(t,e,i){t.events||(t.events={}),a(e,function(e){t.events[e]=function(){i.apply(t,arguments)},k(t.chart.canvas,e,t.events[e])})},n.unbindEvents=function(t,e){a(e,function(e,i){T(t.chart.canvas,i,e)})}),E=n.getMaximumWidth=function(t){var e=t.parentNode,i=parseInt(M(e,"padding-left"))+parseInt(M(e,"padding-right"));return e.clientWidth-i},L=n.getMaximumHeight=function(t){var e=t.parentNode,i=parseInt(M(e,"padding-bottom"))+parseInt(M(e,"padding-top"));return e.clientHeight-i},M=n.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},I=(n.getMaximumSize=n.getMaximumWidth,n.retinaScale=function(t){var e=t.ctx,i=t.canvas.width,n=t.canvas.height;window.devicePixelRatio&&(e.canvas.style.width=i+"px",e.canvas.style.height=n+"px",e.canvas.height=n*window.devicePixelRatio,e.canvas.width=i*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio))}),_=n.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},z=n.fontString=function(t,e,i){return e+" "+t+"px "+i},O=n.longestText=function(t,e,i){t.font=e;var n=0;return a(i,function(e){var i=t.measureText(e).width;n=i>n?i:n}),n},D=n.drawRoundedRectangle=function(t,e,i,n,a,o){t.beginPath(),t.moveTo(e+o,i),t.lineTo(e+n-o,i),t.quadraticCurveTo(e+n,i,e+n,i+o),t.lineTo(e+n,i+a-o),t.quadraticCurveTo(e+n,i+a,e+n-o,i+a),t.lineTo(e+o,i+a),t.quadraticCurveTo(e,i+a,e,i+a-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+o,i),t.closePath()};i.instances={},i.Type=function(t,e,n){this.options=e,this.chart=n,this.id=d(),i.instances[this.id]=this,e.responsive&&this.resize(),this.initialize.call(this,t)},r(i.Type.prototype,{initialize:function(){return this},clear:function(){return _(this.chart),this},stop:function(){return i.animationService.cancelAnimation(this),this},resize:function(t){this.stop();var e=this.chart.canvas,i=E(this.chart.canvas),n=this.options.maintainAspectRatio?i/this.chart.aspectRatio:L(this.chart.canvas);return e.width=this.chart.width=i,e.height=this.chart.height=n,I(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:u,render:function(t){if(t&&this.reflow(),this.options.animation&&!t){var e=new i.Animation;e.numSteps=this.options.animationSteps,e.easing=this.options.animationEasing,e.render=function(t,e){var i=n.easingEffects[e.easing],a=e.currentStep/e.numSteps,o=i(a);t.draw(o,a,e.currentStep)},e.onAnimationProgress=this.options.onAnimationProgress,e.onAnimationComplete=this.options.onAnimationComplete,i.animationService.addAnimation(this,e)}else this.draw(),this.options.onAnimationComplete.call(this);return this},generateLegend:function(){return x(this.options.legendTemplate,this)},destroy:function(){this.clear(),P(this,this.events);var t=this.chart.canvas;t.width=this.chart.width,t.height=this.chart.height,t.style.removeProperty?(t.style.removeProperty("width"),t.style.removeProperty("height")):(t.style.removeAttribute("width"),t.style.removeAttribute("height")),delete i.instances[this.id]},showTooltip:function(t,e){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var o=function(t){var e=!1;return t.length!==this.activeElements.length?e=!0:(a(t,function(t,i){t!==this.activeElements[i]&&(e=!0)},this),e)}.call(this,t);if(o||e){if(this.activeElements=t,this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),t.length>0)if(this.datasets&&this.datasets.length>1){for(var r,s,c=this.datasets.length-1;c>=0&&(r=this.datasets[c].points||this.datasets[c].bars||this.datasets[c].segments,s=l(r,t[0]),-1===s);c--);var u=[],d=[],h=function(){var t,e,i,a,o,r=[],l=[],c=[];return n.each(this.datasets,function(e){t=e.points||e.bars||e.segments,t[s]&&t[s].hasValue()&&r.push(t[s])}),n.each(r,function(t){l.push(t.x),c.push(t.y),u.push(n.template(this.options.multiTooltipTemplate,t)),d.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),o=g(c),i=m(c),a=g(l),e=m(l),{x:a>this.chart.width/2?a:e,y:(o+i)/2}}.call(this,s);new i.MultiTooltip({x:h.x,y:h.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:u,legendColors:d,legendColorBackground:this.options.multiTooltipKeyBackground,title:t[0].label,chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else a(t,function(t){var e=t.tooltipPosition();new i.Tooltip({x:Math.round(e.x),y:Math.round(e.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:x(this.options.tooltipTemplate,t),chart:this.chart,custom:this.options.customTooltips}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),i.Type.extend=function(t){var e=this,n=function(){return e.apply(this,arguments)};if(n.prototype=o(e.prototype),r(n.prototype,t),n.extend=i.Type.extend,t.name||e.prototype.name){var a=t.name||e.prototype.name,l=i.defaults[e.prototype.name]?o(i.defaults[e.prototype.name]):{};i.defaults[a]=r(l,t.defaults),i.types[a]=n,i.prototype[a]=function(t,e){var o=s(i.defaults.global,i.defaults[a],e||{});return new n(t,o,this)}}else h("Name not provided for this chart, so it hasn't been registered");return e},i.Element=function(t){r(this,t),this.initialize.apply(this,arguments),this.save()},r(i.Element.prototype,{initialize:function(){},restore:function(t){return t?a(t,function(t){this[t]=this._saved[t]},this):r(this,this._saved),this},save:function(){return this._saved=o(this),delete this._saved._saved,this},update:function(t){return a(t,function(t,e){this._saved[e]=this[e],this[e]=t},this),this},transition:function(t,e){return a(t,function(t,i){this[i]=(t-this._saved[i])*e+this._saved[i]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return f(this.value)}}),i.Element.extend=c,i.Point=i.Element.extend({display:!0,inRange:function(t,e){var i=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<Math.pow(i,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),i.Arc=i.Element.extend({inRange:function(t,e){var i=n.getAngleFromPoint(this,{x:t,y:e}),a=i.angle>=this.startAngle&&i.angle<=this.endAngle,o=i.distance>=this.innerRadius&&i.distance<=this.outerRadius;return a&&o},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,e=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*e,y:this.y+Math.sin(t)*e}},draw:function(t){var e=this.ctx;e.beginPath(),e.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),e.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),e.closePath(),e.strokeStyle=this.strokeColor,e.lineWidth=this.strokeWidth,e.fillStyle=this.fillColor,e.fill(),e.lineJoin="bevel",this.showStroke&&e.stroke()}}),i.Rectangle=i.Element.extend({draw:function(){var t=this.ctx,e=this.width/2,i=this.x-e,n=this.x+e,a=this.base-(this.base-this.y),o=this.strokeWidth/2;this.showStroke&&(i+=o,n-=o,a+=o),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(i,this.base),t.lineTo(i,a),t.lineTo(n,a),t.lineTo(n,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,e){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y&&e<=this.base}}),i.Animation=i.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),i.Tooltip=i.Element.extend({draw:function(){var t=this.chart.ctx;t.font=z(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var e=this.caretPadding=2,i=t.measureText(this.text).width+2*this.xPadding,n=this.fontSize+2*this.yPadding,a=n+this.caretHeight+e;this.x+i/2>this.chart.width?this.xAlign="left":this.x-i/2<0&&(this.xAlign="right"),this.y-a<0&&(this.yAlign="below");var o=this.x-i/2,r=this.y-a;if(t.fillStyle=this.fillColor,this.custom)this.custom(this);else{switch(this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-e),t.lineTo(this.x+this.caretHeight,this.y-(e+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(e+this.caretHeight)),t.closePath(),t.fill();break;case"below":r=this.y+e+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+e),t.lineTo(this.x+this.caretHeight,this.y+e+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+e+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":o=this.x-i+(this.cornerRadius+this.caretHeight);break;case"right":o=this.x-(this.cornerRadius+this.caretHeight)}D(t,o,r,i,n,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,o+i/2,r+n/2)}}}),i.MultiTooltip=i.Element.extend({initialize:function(){this.font=z(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=z(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,e=O(this.ctx,this.font,this.labels)+this.fontSize+3,i=m([e,t]);this.width=i+2*this.xPadding;var n=this.height/2;this.y-n<0?this.y=n:this.y+n>this.chart.height&&(this.y=this.chart.height-n),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var e=this.y-this.height/2+this.yPadding,i=t-1;return 0===t?e+this.titleFontSize/2:e+(1.5*this.fontSize*i+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){if(this.custom)this.custom(this);else{D(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,n.each(this.labels,function(e,i){t.fillStyle=this.textColor,t.fillText(e,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(i+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[i].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}}),i.Scale=i.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(x(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?O(this.ctx,this.font,this.yLabels)+10:0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,e=this.endPoint,i=this.endPoint-this.startPoint;for(this.calculateYRange(i),this.buildYLabels(),this.calculateXLabelRotation();i>this.endPoint-this.startPoint;)i=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(i),this.buildYLabels(),t<this.yLabelWidth&&(this.endPoint=e,this.calculateXLabelRotation())},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,e,i=this.ctx.measureText(this.xLabels[0]).width,n=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=n/2+3,this.xScalePaddingLeft=i/2>this.yLabelWidth?i/2:this.yLabelWidth,this.xLabelRotation=0,this.display){var a,o=O(this.ctx,this.font,this.xLabels);this.xLabelWidth=o;for(var r=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>r&&0===this.xLabelRotation||this.xLabelWidth>r&&this.xLabelRotation<=90&&this.xLabelRotation>0;)a=Math.cos(y(this.xLabelRotation)),t=a*i,e=a*n,t+this.fontSize/2>this.yLabelWidth&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=a*o;this.xLabelRotation>0&&(this.endPoint-=Math.sin(y(this.xLabelRotation))*o+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:u,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var e=this.drawingArea()/(this.min-this.max);return this.endPoint-e*(t-this.min)},calculateX:function(t){var e=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),i=e/Math.max(this.valuesCount-(this.offsetGridLines?0:1),1),n=i*t+this.xScalePaddingLeft;return this.offsetGridLines&&(n+=i/2),Math.round(n)},update:function(t){n.extend(this,t),this.fit()},draw:function(){var t=this.ctx,e=(this.endPoint-this.startPoint)/this.steps,i=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,a(this.yLabels,function(a,o){var r=this.endPoint-e*o,s=Math.round(r),l=this.showHorizontalLines;t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(a,i-10,r),0!==o||l||(l=!0),l&&t.beginPath(),o>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),s+=n.aliasPixel(t.lineWidth),l&&(t.moveTo(i,s),t.lineTo(this.width,s),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(i-5,s),t.lineTo(i,s),t.stroke(),t.closePath()},this),a(this.xLabels,function(e,i){var n=this.calculateX(i)+w(this.lineWidth),a=this.calculateX(i-(this.offsetGridLines?.5:0))+w(this.lineWidth),o=this.xLabelRotation>0,r=this.showVerticalLines;0!==i||r||(r=!0),r&&t.beginPath(),i>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),r&&(t.moveTo(a,this.endPoint),t.lineTo(a,this.startPoint-3),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(a,this.endPoint),t.lineTo(a,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(n,o?this.endPoint+12:this.endPoint+8),t.rotate(-1*y(this.xLabelRotation)),t.font=this.font,t.textAlign=o?"right":"center",t.textBaseline=o?"middle":"top",t.fillText(e,0,0),t.restore()},this))}}),i.RadialScale=i.Element.extend({initialize:function(){this.size=g([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var e=this.drawingArea/(this.max-this.min);return(t-this.min)*e},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(x(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,e,i,n,a,o,r,s,l,c,u,d,h=g([this.height/2-this.pointLabelFontSize-5,this.width/2]),p=this.width,m=0;for(this.ctx.font=z(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),e=0;e<this.valuesCount;e++)t=this.getPointPosition(e,h),i=this.ctx.measureText(x(this.templateString,{value:this.labels[e]})).width+5,0===e||e===this.valuesCount/2?(n=i/2,t.x+n>p&&(p=t.x+n,a=e),t.x-n<m&&(m=t.x-n,r=e)):e<this.valuesCount/2?t.x+i>p&&(p=t.x+i,a=e):e>this.valuesCount/2&&t.x-i<m&&(m=t.x-i,r=e);l=m,c=Math.ceil(p-this.width),o=this.getIndexAngle(a),s=this.getIndexAngle(r),u=c/Math.sin(o+Math.PI/2),d=l/Math.sin(s+Math.PI/2),u=f(u)?u:0,d=f(d)?d:0,this.drawingArea=h-(d+u)/2,this.setCenterPoint(d,u)},setCenterPoint:function(t,e){var i=this.width-e-this.drawingArea,n=t+this.drawingArea;this.xCenter=(n+i)/2,this.yCenter=this.height/2},getIndexAngle:function(t){var e=2*Math.PI/this.valuesCount;return t*e-Math.PI/2},getPointPosition:function(t,e){var i=this.getIndexAngle(t);return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(a(this.yLabels,function(e,i){if(i>0){var n,a=i*(this.drawingArea/this.steps),o=this.yCenter-a;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,a,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var r=0;r<this.valuesCount;r++)n=this.getPointPosition(r,this.calculateCenterOffset(this.min+i*this.stepValue)),0===r?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=z(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var s=t.measureText(e).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-s/2-this.backdropPaddingX,o-this.fontSize/2-this.backdropPaddingY,s+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(e,this.xCenter,o)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var e=this.valuesCount-1;e>=0;e--){if(this.angleLineWidth>0){var i=this.getPointPosition(e,this.calculateCenterOffset(this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(i.x,i.y),t.stroke(),t.closePath()}var n=this.getPointPosition(e,this.calculateCenterOffset(this.max)+5);t.font=z(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var o=this.labels.length,r=this.labels.length/2,s=r/2,l=s>e||e>o-s,c=e===s||e===o-s;t.textAlign=0===e?"center":e===r?"center":r>e?"left":"right",t.textBaseline=c?"middle":l?"bottom":"top",t.fillText(this.labels[e],n.x,n.y)}}}}}),i.animationService={frameDuration:17,animations:[],dropFrames:0,addAnimation:function(t,e){for(var i=0;i<this.animations.length;++i)if(this.animations[i].chartInstance===t)return void(this.animations[i].animationObject=e);this.animations.push({chartInstance:t,animationObject:e}),1==this.animations.length&&n.requestAnimFrame.call(window,this.digestWrapper)},cancelAnimation:function(t){var e=n.findNextWhere(this.animations,function(e){return e.chartInstance===t});e&&this.animations.splice(e,1)},digestWrapper:function(){i.animationService.startDigest.call(i.animationService)},startDigest:function(){var t=Date.now(),e=0;this.dropFrames>1&&(e=Math.floor(this.dropFrames),this.dropFrames-=e);for(var i=0;i<this.animations.length;i++)null===this.animations[i].animationObject.currentStep&&(this.animations[i].animationObject.currentStep=0),this.animations[i].animationObject.currentStep+=1+e,this.animations[i].animationObject.currentStep>this.animations[i].animationObject.numSteps&&(this.animations[i].animationObject.currentStep=this.animations[i].animationObject.numSteps),this.animations[i].animationObject.render(this.animations[i].chartInstance,this.animations[i].animationObject),this.animations[i].animationObject.currentStep==this.animations[i].animationObject.numSteps&&(this.animations.splice(i,1),i--);var a=Date.now(),o=a-t-this.frameDuration,r=o/this.frameDuration;r>1&&(this.dropFrames+=r),this.animations.length>0&&n.requestAnimFrame.call(window,this.digestWrapper)}},n.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){a(i.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),p?define(function(){return i}):"object"==typeof module&&module.exports&&(module.exports=i),t.Chart=i,i.noConflict=function(){return t.Chart=e,i}}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'};e.Type.extend({name:"Doughnut",defaults:n,initialize:function(t){this.segments=[],this.outerRadius=(i.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=e.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];i.each(this.segments,function(t){t.restore(["fillColor"])}),i.each(e,function(t){t.fillColor=t.highlightColor}),this.showTooltip(e)}),this.calculateTotal(t),i.each(t,function(e,i){e.color||(e.color="hsl("+360*i/t.length+", 100%, 50%)"),this.addData(e,i,!0)},this),this.render()},getSegmentsAtEvent:function(t){var e=[],n=i.getRelativePosition(t);return i.each(this.segments,function(t){t.inRange(n.x,n.y)&&e.push(t)},this),e},addData:function(t,e,i){var n=e||this.segments.length;this.segments.splice(n,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label})),i||(this.reflow(),this.update())},calculateCircumference:function(t){return this.total>0?2*Math.PI*(t/this.total):0},calculateTotal:function(t){this.total=0,i.each(t,function(t){this.total+=Math.abs(t.value)},this)},update:function(){this.calculateTotal(this.segments),i.each(this.activeElements,function(t){t.restore(["fillColor"])}),i.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var e=i.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1),this.reflow(),this.update()},reflow:function(){i.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(i.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,i.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var e=t?t:1;this.clear(),i.each(this.segments,function(t,i){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},e),t.endAngle=t.startAngle+t.circumference,t.draw(),0===i&&(t.startAngle=1.5*Math.PI),i<this.segments.length-1&&(this.segments[i+1].startAngle=t.endAngle)
},this)}}),e.types.Doughnut.extend({name:"Pie",defaults:i.merge(n,{percentageInnerCutout:0})})}.call(this),function(t,e){var i=Hogan.compile('<ul class="items options clearfix count-{{count}}">                                            {{#options}}                                            <li class="item option {{#selected}}selected{{/selected}}">                                                <div class="pie">                                                    <canvas class="canvas-outer" data-percent="{{value}}"></canvas>                                                    <div class="num">{{value}}%</div>                                                </div>                                                <p class="text">{{text}}</p>                                            </li>                                            {{/options}}                                        </ul>'),n=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};n.prototype={init:function(){var t=this,i=t.el;return t.formatCount(),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){var e=this,n=e.el;n.on("click",".grid-paper-votable-ft .vote .option",function(e){e.preventDefault();var i=t(e.currentTarget);"true"==n.attr("data-multiSelect")?i.toggleClass("selected"):(i.siblings(".selected").removeClass("selected"),i.addClass("selected"))}),n.on("click",".grid-paper-votable-ft .btn",function(a){a.preventDefault();var o=t(a.currentTarget),r=n.find(".grid-paper-votable-ft .vote"),s=n.find(".grid-paper-votable-ft .result"),l=[];return o.hasClass("disabled")?!1:(n.find(".grid-paper-votable-ft .vote .selected").each(function(e,i){var n=t(i);l.push(n.attr("data-optionId"))}),l.length?(o.addClass("disabled"),void t.ajax({url:"/mobile/papers/vote_create",type:"POST",dataType:"json",data:{paper_id:n.attr("data-id"),options:l.join(",")},success:function(t){if(t&&t.status){for(var n=t.data,a=n.options,l="",c=a.length;a.length;)l+=i.render({options:a.slice(0,4),count:c}),a=a.slice(4);o.find(".text").text("\u5df2\u6295\u7968"),r.hide(),s.append(l)&&s.show()&&e.renderPie()}else o.removeClass("disabled")},error:function(){o.removeClass("disabled")}})):(t.fn.utils.showNotification("\u81f3\u5c11\u8981\u9009\u62e9\u4e00\u4e2a\u54e6~"),!1))})},formatCount:function(){var t,e,i,n=this,a=n.el,o=a.find(".grid-paper-votable-bd .count"),r=!1;o.length&&(e=new Date,t=new Date(o.attr("data-publishDate").replace(/-/g,"/")),i=Math.round((e.getTime()-t.getTime())/6e4),i<=60*e.getHours()&&(r=!0),r&&(o.addClass("new"),o.find(".num").remove(),o.find(".text").text("NEW")),o.find(".num, .text").css("display","block"))},renderPie:function(){var e,i,n,a=this,o=a.el,r=o.find(".pie canvas");r.each(function(){{var a=t(this);a.parents(".option")}a[0]&&a[0].getContext&&(i=a[0].getContext("2d"),i&&(n=parseFloat(a.attr("data-percent")),e=[{value:n,color:"#ffa200"},{value:100-n,color:"#ffffff"}],new Chart(i).Doughnut(e,{showTooltips:!1,segmentShowStroke:!1,animationSteps:60,percentageInnerCutout:80,animationEasing:"easeInOutQuart"})))})}},t.fn.GridPaperVotable=function(e){var i;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(i=new n(a,e),i.init())})}}(window.jQuery||window.Zepto,window,document),function(t,e){var i=function(e,i){this.el=e,this.defaults={},this.options=t.extend({},this.defaults,i)};i.prototype={init:function(){var t=this,i=t.el;return t.initMapWrapper(),i.find(".com-grid-key-article").GridKeyArticle(),i.find(".com-grid-paper").GridPaper(),i.find(".com-grid-paper-votable").GridPaperVotable(),t.bindEvents(),e.COMS=e.COMS||[],i.attr("data-initialized","true"),i.attr("data-guid",e.COMS.length),e.COMS.push(t),t},bindEvents:function(){{var t=this;t.el}},initMapWrapper:function(){var e=this,i=e.el,n=i.find(".map-wrapper");n.each(function(){var e=t(this),i="s&wd="+e.attr("data-locname"),n=e.attr("href");e.attr("href",n+encodeURIComponent(i))})}},t.fn.RelatedBanners=function(e){var n;return this.each(function(){var a=t(this);"true"!=a.attr("data-initialized")&&(n=new i(a,e),n.init())})}}(window.jQuery||window.Zepto,window,document),$(function(){var t=$("body");FastClick.attach(document.body),t.find(".com-header").Header(),t.find(".com-toolbar").Toolbar(),t.find(".com-article-detail").ArticleDetail(),t.find(".com-guoqing-detail").GuoqingDetail(),t.find(".com-related-articles").RelatedArticles(),t.find(".com-related-banners").RelatedBanners(),t.find(".com-related-comments").RelatedComments({prefetch:!0,baseUrl:"/mobile/comments/article/"+t.find(".com-related-comments").attr("data-id")}),$.fn.initLoginStatus(),t.find(".com-comment-popup").on("CommentPopup::addComment",function(t,e){$.fn.utils.getComponentInstance(".com-related-comments").addComment(e.data,e.isReplyComment)})});